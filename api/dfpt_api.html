<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>dfpt Package &#8212; abipy 0.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="display Package" href="display_api.html" />
    <link rel="prev" title="data Package" href="data_api.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          abipy</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Getting AbiPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzbiblio.html">Bibliography</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">AbiPy Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts_howto.html">Post-processing How-To</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workflows/taskmanager.html">TaskManager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/manager_examples.html">Manager Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flow_gallery/index.html">Flow Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flows_howto.html">Flows How-To</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devel/index.html">Developers’ Guide</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">dfpt Package</a><ul>
<li><a class="reference internal" href="#module-abipy.dfpt"><code class="docutils literal"><span class="pre">dpft</span></code> Package</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.anaddbnc"><code class="docutils literal"><span class="pre">anaddbnc</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.ddb"><code class="docutils literal"><span class="pre">ddb</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.gruneisen"><code class="docutils literal"><span class="pre">gruneisen</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.phonons"><code class="docutils literal"><span class="pre">phonons</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.tensors"><code class="docutils literal"><span class="pre">tensors</span></code> Module</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="data_api.html" title="Previous Chapter: data Package"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; data Package</span>
    </a>
  </li>
  <li>
    <a href="display_api.html" title="Next Chapter: display Package"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">display Package &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/api/dfpt_api.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="dfpt-package">
<h1><a class="toc-backref" href="#contents">dfpt Package</a><a class="headerlink" href="#dfpt-package" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#dfpt-package" id="id2">dfpt Package</a><ul>
<li><a class="reference internal" href="#module-abipy.dfpt" id="id3"><code class="xref py py-mod docutils literal"><span class="pre">dpft</span></code> Package</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.anaddbnc" id="id4"><code class="xref py py-mod docutils literal"><span class="pre">anaddbnc</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.ddb" id="id5"><code class="xref py py-mod docutils literal"><span class="pre">ddb</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.gruneisen" id="id6"><code class="xref py py-mod docutils literal"><span class="pre">gruneisen</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.phonons" id="id7"><code class="xref py py-mod docutils literal"><span class="pre">phonons</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.tensors" id="id8"><code class="xref py py-mod docutils literal"><span class="pre">tensors</span></code> Module</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-abipy.dfpt">
<span id="dpft-package"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">dpft</span></code> Package</a><a class="headerlink" href="#module-abipy.dfpt" title="Permalink to this headline">¶</a></h2>
<p>This subpackage provides objects and functions for the analysis of DFPT calculatios.</p>
</div>
<div class="section" id="module-abipy.dfpt.anaddbnc">
<span id="anaddbnc-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">anaddbnc</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.anaddbnc" title="Permalink to this headline">¶</a></h2>
<p>AnaddbNcFile provides a high-level interface to the data stored in the anaddb.nc file.</p>
<dl class="class">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile">
<em class="property">class </em><code class="descclassname">abipy.dfpt.anaddbnc.</code><code class="descname">AnaddbNcFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>AnaddbNcFile provides a high-level interface to the data stored in the anaddb.nc file.
This object is usually instanciated with <cite>abiopen(“anaddb.nc”)</cite>.</p>
<dl class="attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.emacro">
<code class="descname">emacro</code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.emacro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.emacro" title="Permalink to this definition">¶</a></dt>
<dd><p>Macroscopic dielectric tensor. None if the file does not contain this information.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.becs">
<code class="descname">becs</code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.becs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.becs" title="Permalink to this definition">¶</a></dt>
<dd><p>Born effective charges. None if the file does not contain this inf</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.ifc">
<code class="descname">ifc</code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.ifc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.ifc" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">InteratomicForceConstants</span></code> object with the interatomic force constants calculated by anaddb.
None, if the netcdf file does not contain the IFCs.</p>
</dd></dl>

<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-b374e3d7bed78ad7a9c552ea6cb7965ffdff0aaf.png" alt="Inheritance diagram of AnaddbNcFile" usemap="#inheritance8defe6c584" class="inheritance"/>
<map id="inheritance8defe6c584" name="inheritance8defe6c584">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="16,5,214,29"/>
<area shape="rect" id="node4" href="#abipy.dfpt.anaddbnc.AnaddbNcFile" target="_top" title="AnaddbNcFile provides a high&#45;level interface to the data stored in the anaddb.nc file." alt="" coords="273,53,501,77"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="9,53,221,77"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,101,225,125"/>
</map>
<dl class="classmethod">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> – verbosity level.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">structure</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">emacro</code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.emacro"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Macroscopic dielectric tensor. None if the file does not contain this information.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.emacro_rlx">
<code class="descname">emacro_rlx</code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.emacro_rlx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.emacro_rlx" title="Permalink to this definition">¶</a></dt>
<dd><p>Relaxed ion Macroscopic dielectric tensor. None if the file does not contain this information.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">becs</code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.becs"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Born effective charges. None if the file does not contain this information.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">ifc</code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.ifc"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>The interatomic force constants calculated by anaddb.
The following anaddb variables should be used in the run: <code class="docutils literal"><span class="pre">ifcflag</span></code>, <code class="docutils literal"><span class="pre">natifc</span></code>, <code class="docutils literal"><span class="pre">atifc</span></code>, <code class="docutils literal"><span class="pre">ifcout</span></code>.
Return None, if the <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file does not contain the IFCs,</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.dchide">
<code class="descname">dchide</code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.dchide"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.dchide" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-linear optical susceptibility tensor.
Returns a <code class="xref py py-class docutils literal"><span class="pre">NLOpticalSusceptibilityTensor</span></code> or None if the file does not contain this information.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.dchidt">
<code class="descname">dchidt</code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.dchidt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.dchidt" title="Permalink to this definition">¶</a></dt>
<dd><p>First-order change in the linear dielectric susceptibility.
Returns a list of lists of 3x3 Tensor object with shape (number of atoms, 3).
The [i][j] element of the list contains the Tensor representing the change due to the
displacement of the ith atom in the jth direction.
None if the file does not contain this information.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.oscillator_strength">
<code class="descname">oscillator_strength</code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.oscillator_strength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.oscillator_strength" title="Permalink to this definition">¶</a></dt>
<dd><p>A complex <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> containing the oscillator strengths with shape (number of phonon modes, 3, 3),
in a.u. (1 a.u.=253.2638413 m3/s2).
None if the file does not contain this information.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.ddb">
<span id="ddb-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">ddb</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.ddb" title="Permalink to this headline">¶</a></h2>
<p>DDB File.</p>
<dl class="exception">
<dt id="abipy.dfpt.ddb.DdbError">
<em class="property">exception </em><code class="descclassname">abipy.dfpt.ddb.</code><code class="descname">DdbError</code><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">Exception</span></code></p>
<p>Error class raised by DDB.</p>
</dd></dl>

<dl class="exception">
<dt id="abipy.dfpt.ddb.AnaddbError">
<em class="property">exception </em><code class="descclassname">abipy.dfpt.ddb.</code><code class="descname">AnaddbError</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#AnaddbError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.AnaddbError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.dfpt.ddb.DdbError" title="abipy.dfpt.ddb.DdbError"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.ddb.DdbError</span></code></a></p>
<p>Exceptions raised when we try to execute <code class="xref py py-class docutils literal"><span class="pre">AnaddbTask</span></code> in the <a class="reference internal" href="#abipy.dfpt.ddb.DdbFile" title="abipy.dfpt.ddb.DdbFile"><code class="xref py py-class docutils literal"><span class="pre">DdbFile</span></code></a> methods</p>
<p>An <cite>AnaddbError</cite> has a reference to the task and to the <code class="xref py py-class docutils literal"><span class="pre">EventsReport</span></code> that contains
the error messages of the run.</p>
</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.ddb.DdbFile">
<em class="property">class </em><code class="descclassname">abipy.dfpt.ddb.</code><code class="descname">DdbFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.TextFile</span></code>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>This object provides an interface to the <a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/ddb.ipynb">DDB</a> file produced by ABINIT
as well as methods to compute phonon band structures, phonon DOS, thermodinamical properties …</p>
<p>About the indices (idir, ipert) used by Abinit (Fortran notation)</p>
<ul>
<li><p class="first">idir in [1, 2, 3] gives the direction (usually reduced direction)</p>
</li>
<li><p class="first">ipert in [1, 2, …, mpert] where mpert = natom + 6</p>
<blockquote>
<div><ul class="simple">
<li>ipert in [1, …, natom] corresponds to atomic perturbations</li>
<li>ipert = natom + 1 gives d/dk</li>
<li>ipert = natom + 2 gives the electric field</li>
<li>ipert = natom + 3 gives the uniaxial stress</li>
<li>ipert = natom + 4 gives the shear stree.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p class="rubric">Inheritance</p>
<img src="../_images/inheritance-3308638c680b49bd33e751d25767e235e5ee5b29.png" alt="Inheritance diagram of DdbFile" usemap="#inheritancecb0cf3a7e1" class="inheritance"/>
<map id="inheritancecb0cf3a7e1" name="inheritancecb0cf3a7e1">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="9,5,221,29"/>
<area shape="rect" id="node4" href="#abipy.dfpt.ddb.DdbFile" target="_top" title="This object provides an interface to the DDB_ file produced by ABINIT" alt="" coords="273,53,427,77"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,53,225,77"/>
</map>
<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbFile.Error">
<code class="descname">Error</code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#abipy.dfpt.ddb.DdbError" title="abipy.dfpt.ddb.DdbError"><code class="xref py py-class docutils literal"><span class="pre">DdbError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="abipy.dfpt.ddb.DdbFile.AnaddbError">
<em class="property">exception </em><code class="descname">AnaddbError</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.AnaddbError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.dfpt.ddb.DdbError" title="abipy.dfpt.ddb.DdbError"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.ddb.DdbError</span></code></a></p>
<p>Exceptions raised when we try to execute <code class="xref py py-class docutils literal"><span class="pre">AnaddbTask</span></code> in the <a class="reference internal" href="#abipy.dfpt.ddb.DdbFile" title="abipy.dfpt.ddb.DdbFile"><code class="xref py py-class docutils literal"><span class="pre">DdbFile</span></code></a> methods</p>
<p>An <cite>AnaddbError</cite> has a reference to the task and to the <code class="xref py py-class docutils literal"><span class="pre">EventsReport</span></code> that contains
the error messages of the run.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.dfpt.ddb.DdbFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Needed for the <cite>AbinitFile</cite> abstract interface.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbFile.natom">
<code class="descname">natom</code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.natom" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms in structure</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbFile.version">
<code class="descname">version</code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.version" title="Permalink to this definition">¶</a></dt>
<dd><p>DDB Version number (integer).</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbFile.header">
<code class="descname">header</code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.header" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the values reported in the header section.
Use e.g. <code class="docutils literal"><span class="pre">ddb.header.ecut</span></code> to access its values</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbFile.computed_dynmat">
<code class="descname">computed_dynmat</code><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.computed_dynmat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.computed_dynmat" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> mapping q-point object to –&gt; pandas Dataframe.
The <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0.dev0+427.gee9c7e9.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> contains the columns: “idir1”, “ipert1”, “idir2”, “ipert2”, “cvalue”
and (idir1, ipert1, idir2, ipert2) as index.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The indices follow the Abinit (Fortran) notation so they start at 1.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbFile.blocks">
<code class="descname">blocks</code><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.blocks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>DDB blocks. List of dictionaries, Each dictionary contains the following keys.
“qpt” with the reduced coordinates of the q-point.
“data” that is a list of strings with the entries of the dynamical matrix for this q-point.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbFile.qpoints">
<code class="descname">qpoints</code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.KpointList</span></code> object with the list of q-points in reduced coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.has_qpoint">
<code class="descname">has_qpoint</code><span class="sig-paren">(</span><em>qpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_qpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains this q-point.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.qindex">
<code class="descname">qindex</code><span class="sig-paren">(</span><em>qpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.qindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.qindex" title="Permalink to this definition">¶</a></dt>
<dd><p>The index of the q-point in the internal list of q-points.
Accepts: <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> instance or integer.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbFile.guessed_ngqpt">
<code class="descname">guessed_ngqpt</code><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.guessed_ngqpt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.guessed_ngqpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Guess for the q-mesh divisions (ngqpt) inferred from the list of
q-points found in the DDB file.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The mesh may not be correct if the DDB file contains points belonging
to different meshes and/or the Q-mesh is shifted.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the parameters that are usually tested for convergence.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.has_lo_to_data">
<code class="descname">has_lo_to_data</code><span class="sig-paren">(</span><em>select='at_least_one'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_lo_to_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_lo_to_data" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains the data required to compute the LO-TO splitting.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.has_emacro_terms">
<code class="descname">has_emacro_terms</code><span class="sig-paren">(</span><em>select='at_least_one'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_emacro_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_emacro_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains info on the electric-field perturbation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>select</strong> – Possible values in [“at_least_one”, “all”]
If select == “at_least_one”, we check if there’s at least one entry associated to the electric field.
and we assume that anaddb will be able to reconstruct the full tensor by symmetry.
If select == “all”, all tensor components must be present in the DDB file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.has_bec_terms">
<code class="descname">has_bec_terms</code><span class="sig-paren">(</span><em>select='at_least_one'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_bec_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_bec_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains info on the Born effective charges.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>select</strong> – Possible values in [“at_least_one”, “all”]
By default, we check if there’s at least one entry associated to atomic displacement
and electric field and we assume that anaddb will be able to reconstruct the full tensor by symmetry.
If select == “all”, all bec components must be present in the DDB file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_phmodes_at_qpoint">
<code class="descname">anaget_phmodes_at_qpoint</code><span class="sig-paren">(</span><em>qpoint=None</em>, <em>asr=2</em>, <em>chneut=1</em>, <em>dipdip=1</em>, <em>workdir=None</em>, <em>mpi_procs=1</em>, <em>manager=None</em>, <em>verbose=0</em>, <em>lo_to_splitting=False</em>, <em>directions=None</em>, <em>anaddb_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_phmodes_at_qpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_phmodes_at_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute anaddb to compute phonon modes at the given q-point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qpoint</strong> – Reduced coordinates of the qpoint where phonon modes are computed.</li>
<li><strong>chneut</strong><strong>, </strong><strong>dipdp</strong> (<em>asr</em><em>,</em>) – Anaddb input variable. See official documentation.</li>
<li><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</li>
<li><strong>mpi_procs</strong> – Number of MPI processes to use.</li>
<li><strong>manager</strong> – <a class="reference external" href="http://pymatgen.org/pymatgen.io.abinit.tasks.html#pymatgen.io.abinit.tasks.TaskManager" title="(in pymatgen v2017.12.16)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.io.abinit.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</li>
<li><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</li>
<li><strong>lo_to_splitting</strong> – if True the LO-TO splitting will be calculated if qpoint==Gamma and the non_anal_directions
non_anal_phfreqs attributes will be added to the returned object</li>
<li><strong>directions</strong> – list of 3D directions along which the LO-TO splitting will be calculated. If None the three
cartesian direction will be used</li>
<li><strong>anaddb_kwargs</strong> – additional kwargs for anaddb</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_phbst_and_phdos_files">
<code class="descname">anaget_phbst_and_phdos_files</code><span class="sig-paren">(</span><em>nqsmall=10</em>, <em>ndivsm=20</em>, <em>asr=2</em>, <em>chneut=1</em>, <em>dipdip=1</em>, <em>dos_method='tetra'</em>, <em>lo_to_splitting=False</em>, <em>ngqpt=None</em>, <em>qptbounds=None</em>, <em>anaddb_kwargs=None</em>, <em>verbose=0</em>, <em>mpi_procs=1</em>, <em>workdir=None</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_phbst_and_phdos_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_phbst_and_phdos_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute anaddb to compute the phonon band structure and the phonon DOS</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nqsmall</strong> – Defines the homogeneous q-mesh used for the DOS. Gives the number of divisions
used to sample the smallest lattice vector.</li>
<li><strong>ndivsm</strong> – Number of division used for the smallest segment of the q-path</li>
<li><strong>chneut</strong><strong>, </strong><strong>dipdip</strong> (<em>asr</em><em>,</em>) – Anaddb input variable. See official documentation.</li>
<li><strong>dos_method</strong> – Technique for DOS computation in  Possible choices: “tetra”, “gaussian” or “gaussian:0.001 eV”.
In the later case, the value 0.001 eV is used as gaussian broadening</li>
<li><strong>lo_to_splitting</strong> – if True the LO-TO splitting will be calculated and included in the band structure</li>
<li><strong>ngqpt</strong> – Number of divisions for the q-mesh in the DDB file. Auto-detected if None (default)</li>
<li><strong>qptbounds</strong> – Boundaries of the path. If None, the path is generated from an internal database
depending on the input structure.</li>
<li><strong>anaddb_kwargs</strong> – additional kwargs for anaddb</li>
<li><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</li>
<li><strong>mpi_procs</strong> – Number of MPI processes to use.</li>
<li><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</li>
<li><strong>manager</strong> – <a class="reference external" href="http://pymatgen.org/pymatgen.io.abinit.tasks.html#pymatgen.io.abinit.tasks.TaskManager" title="(in pymatgen v2017.12.16)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.io.abinit.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#abipy.dfpt.phonons.PhbstFile" title="abipy.dfpt.phonons.PhbstFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhbstFile</span></code></a> with the phonon band structure.
<a class="reference internal" href="#abipy.dfpt.phonons.PhdosFile" title="abipy.dfpt.phonons.PhdosFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhdosFile</span></code></a> with the the phonon DOS.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.anacompare_phdos">
<code class="descname">anacompare_phdos</code><span class="sig-paren">(</span><em>nqsmalls</em>, <em>asr=2</em>, <em>chneut=1</em>, <em>dipdip=1</em>, <em>dos_method='tetra'</em>, <em>ngqpt=None</em>, <em>num_cpus=1</em>, <em>stream=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anacompare_phdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anacompare_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke Anaddb to compute Phonon DOS with different q-meshes. The ab-initio dynamical matrix
reported in the <a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/ddb.ipynb">DDB</a> file will be Fourier-interpolated on the list of q-meshes specified
by <code class="docutils literal"><span class="pre">nqsmalls</span></code>. Useful to perform covergence studies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nqsmalls</strong> – List of integers defining the q-mesh for the DOS. Each integer gives
the number of divisions to be used to sample the smallest reciprocal lattice vector.</li>
<li><strong>chneut</strong><strong>, </strong><strong>dipdp</strong> (<em>asr</em><em>,</em>) – Anaddb input variable. See official documentation.</li>
<li><strong>dos_method</strong> – Technique for DOS computation in  Possible choices: “tetra”, “gaussian” or “gaussian:0.001 eV”.
In the later case, the value 0.001 eV is used as gaussian broadening</li>
<li><strong>ngqpt</strong> – Number of divisions for the ab-initio q-mesh in the DDB file. Auto-detected if None (default)</li>
<li><strong>num_cpus</strong> – Number of CPUs (threads) used to parallellize the calculation of the DOSes. Autodetected if None.</li>
<li><strong>stream</strong> – File-like object used for printing.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p><code class="docutils literal"><span class="pre">namedtuple</span></code> with the following attributes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>phdoses: List of |PhononDos| objects
plotter: |PhononDosPlotter| object.
    Client code can use ``plotter.gridplot()`` to visualize the results.
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_emacro_and_becs">
<code class="descname">anaget_emacro_and_becs</code><span class="sig-paren">(</span><em>chneut=1</em>, <em>mpi_procs=1</em>, <em>workdir=None</em>, <em>manager=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_emacro_and_becs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_emacro_and_becs" title="Permalink to this definition">¶</a></dt>
<dd><p>Call anaddb to compute the macroscopic dielectric tensor and the Born effective charges.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chneut</strong> – Anaddb input variable. See official documentation.</li>
<li><strong>manager</strong> – <a class="reference external" href="http://pymatgen.org/pymatgen.io.abinit.tasks.html#pymatgen.io.abinit.tasks.TaskManager" title="(in pymatgen v2017.12.16)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.io.abinit.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</li>
<li><strong>mpi_procs</strong> – Number of MPI processes to use.</li>
<li><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(emacro, becs)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_ifc">
<code class="descname">anaget_ifc</code><span class="sig-paren">(</span><em>ifcout=None</em>, <em>asr=2</em>, <em>chneut=1</em>, <em>dipdip=1</em>, <em>ngqpt=None</em>, <em>mpi_procs=1</em>, <em>workdir=None</em>, <em>manager=None</em>, <em>verbose=0</em>, <em>anaddb_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_ifc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_ifc" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute anaddb to compute the interatomic forces.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ifcout</strong> – Number of neighbouring atoms for which the ifc’s will be output. If None all the atoms in the big box.</li>
<li><strong>chneut</strong><strong>, </strong><strong>dipdip</strong> (<em>asr</em><em>,</em>) – Anaddb input variable. See official documentation.</li>
<li><strong>ngqpt</strong> – Number of divisions for the q-mesh in the DDB file. Auto-detected if None (default)</li>
<li><strong>mpi_procs</strong> – Number of MPI processes to use.</li>
<li><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</li>
<li><strong>manager</strong> – <a class="reference external" href="http://pymatgen.org/pymatgen.io.abinit.tasks.html#pymatgen.io.abinit.tasks.TaskManager" title="(in pymatgen v2017.12.16)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.io.abinit.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</li>
<li><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</li>
<li><strong>anaddb_kwargs</strong> – additional kwargs for anaddb</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal"><span class="pre">InteratomicForceConstants</span></code> with the calculated ifc.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.update_header">
<code class="descname">update_header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.update_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.update_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the header.lines with the variables contained in the header dictionary
The variables are written from a list in the correct order (check if this is necessary)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the DDB file in filepath. Requires the blocks data.
Only the information stored in self.header.lines and in self.blocks will be used to produce the file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.get_block_for_qpoint">
<code class="descname">get_block_for_qpoint</code><span class="sig-paren">(</span><em>qpt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.get_block_for_qpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.get_block_for_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the block data for the selected qpoint.
Returns a list of lines containing the block information</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.replace_block_for_qpoint">
<code class="descname">replace_block_for_qpoint</code><span class="sig-paren">(</span><em>qpt</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.replace_block_for_qpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.replace_block_for_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the block data for the selected qpoint. Object is modified in-place.
Data should be a list of strings representing the whole data block.
Note that the DDB file should be written and reopened in order to call methods that run anaddb.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">True if qpt has been found and data has been replaced.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.ddb.Becs">
<em class="property">class </em><code class="descclassname">abipy.dfpt.ddb.</code><code class="descname">Becs</code><span class="sig-paren">(</span><em>becs_arr</em>, <em>structure</em>, <em>chneut</em>, <em>order='c'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#Becs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.Becs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a></p>
<p>This object stores the Born effective charges and provides simple tools for data analysis.</p>
<dl class="attribute">
<dt id="abipy.dfpt.ddb.Becs.becs">
<code class="descname">becs</code><a class="headerlink" href="#abipy.dfpt.ddb.Becs.becs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.ddb.Becs.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.dfpt.ddb.Becs.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.Becs.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#Becs.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.Becs.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.Becs.check_sumrule">
<code class="descname">check_sumrule</code><span class="sig-paren">(</span><em>stream=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#Becs.check_sumrule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.Becs.check_sumrule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.ddb.ElasticComplianceTensor">
<em class="property">class </em><code class="descclassname">abipy.dfpt.ddb.</code><code class="descname">ElasticComplianceTensor</code><span class="sig-paren">(</span><em>elastic_tensor</em>, <em>compliance_tensor</em>, <em>structure</em>, <em>additional_info=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#ElasticComplianceTensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.ElasticComplianceTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a></p>
<p>This object is used to store the elastic and compliance tensors.</p>
<dl class="attribute">
<dt id="abipy.dfpt.ddb.ElasticComplianceTensor.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.dfpt.ddb.ElasticComplianceTensor.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.dfpt.ddb.ElasticComplianceTensor.from_ec_nc_file">
<em class="property">classmethod </em><code class="descname">from_ec_nc_file</code><span class="sig-paren">(</span><em>ec_nc_file</em>, <em>tensor_type='relaxed_ion'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#ElasticComplianceTensor.from_ec_nc_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.ElasticComplianceTensor.from_ec_nc_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.ElasticComplianceTensor.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#ElasticComplianceTensor.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.ElasticComplianceTensor.as_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.ElasticComplianceTensor.extended_dict">
<code class="descname">extended_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#ElasticComplianceTensor.extended_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.ElasticComplianceTensor.extended_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.dfpt.ddb.ElasticComplianceTensor.from_dict">
<em class="property">classmethod </em><code class="descname">from_dict</code><span class="sig-paren">(</span><em>dd</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#ElasticComplianceTensor.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.ElasticComplianceTensor.from_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.ElasticComplianceTensor.get_pmg_elastic_tensor">
<code class="descname">get_pmg_elastic_tensor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#ElasticComplianceTensor.get_pmg_elastic_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.ElasticComplianceTensor.get_pmg_elastic_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts to a pymatgen <code class="xref py py-class docutils literal"><span class="pre">ElasticTensor</span></code> object.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator">
<em class="property">class </em><code class="descclassname">abipy.dfpt.ddb.</code><code class="descname">DielectricTensorGenerator</code><span class="sig-paren">(</span><em>phfreqs</em>, <em>oscillator_strength</em>, <em>emacro</em>, <em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a></p>
<p>Object used to generate frequency dependent dielectric tensors as obtained
from DFPT calculations. The values are calculated on the fly
based on the phonon frequencies at gamma and oscillator strengths.
The first three frequencies would be considered as acoustic modes and
ignored in the calculation. No checks would be performed.</p>
<dl class="attribute">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.from_files">
<em class="property">classmethod </em><code class="descname">from_files</code><span class="sig-paren">(</span><em>phbst_filepath</em>, <em>anaddbnc_filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.from_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.from_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the object from the files that contain the phonon frequencies, oscillator strength and
static dielectric tensor, i.e. the PHBST.nc and anaddb.nc netcdf files, respectively.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.from_objects">
<em class="property">classmethod </em><code class="descname">from_objects</code><span class="sig-paren">(</span><em>phbands</em>, <em>anaddbnc</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.from_objects"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.from_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the object from the objects <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> object and AnaddbNcFile</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.tensor_at_frequency">
<code class="descname">tensor_at_frequency</code><span class="sig-paren">(</span><em>w</em>, <em>units='eV'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.tensor_at_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.tensor_at_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <code class="xref py py-class docutils literal"><span class="pre">DielectricTensor</span></code> object representing
the dielectric tensor in atomic units at the specified frequency w.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>w</strong> – frequency</li>
<li><strong>units</strong> – string specifying the units used for the frequency. Accepted values are Ha, eV (default), cm-1</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.plot_vs_w">
<code class="descname">plot_vs_w</code><span class="sig-paren">(</span><em>w_min</em>, <em>w_max</em>, <em>num</em>, <em>component='diago'</em>, <em>units='eV'</em>, <em>ax=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.plot_vs_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.plot_vs_w" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the selected components of the dielectric tensor as a function of the frequency.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>w_min</strong> – minimum frequency.</li>
<li><strong>w_max</strong> – maximum frequency.</li>
<li><strong>num</strong> – number of values of the frequencies between w_min and w_max.</li>
<li><strong>component</strong> – <p>determine which components of the tensor will be displayed. Can be a list/tuple of two
elements, indicating the indices [i, j] of the desired component or a string among:</p>
<ul>
<li>’diag’ to plot the elements on diagonal</li>
<li>’all’ to plot all the components</li>
<li>’diag_av’ to plot the average of the components on the diagonal</li>
</ul>
</li>
<li><strong>units</strong> – string specifying the units used for the frequency. Accepted values are Ha, eV (default), cm-1</li>
<li><strong>fontsize</strong> – Legend and label fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.ddb.DdbRobot">
<em class="property">class </em><code class="descclassname">abipy.dfpt.ddb.</code><code class="descname">DdbRobot</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="abio_api.html#abipy.abio.robots.Robot" title="abipy.abio.robots.Robot"><code class="xref py py-class docutils literal"><span class="pre">abipy.abio.robots.Robot</span></code></a></p>
<p>This robot analyzes the results contained in multiple <a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/ddb.ipynb">DDB</a> files.</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-bfd552dbf742bcd030f9db61f771a32c651f3b43.png" alt="Inheritance diagram of DdbRobot" usemap="#inheritance0460c10005" class="inheritance"/>
<map id="inheritance0460c10005" name="inheritance0460c10005">
<area shape="rect" id="node1" href="abio_api.html#abipy.abio.robots.Robot" target="_top" title="This is the base class from which all Robot subclasses should derive." alt="" coords="273,5,434,29"/>
<area shape="rect" id="node3" href="#abipy.dfpt.ddb.DdbRobot" target="_top" title="This robot analyzes the results contained in multiple DDB_ files." alt="" coords="482,5,650,29"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,5,225,29"/>
</map>
<dl class="attribute">
<dt id="abipy.dfpt.ddb.DdbRobot.EXT">
<code class="descname">EXT</code><em class="property"> = 'DDB'</em><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.EXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.dfpt.ddb.DdbRobot.class_handles_filename">
<em class="property">classmethod </em><code class="descname">class_handles_filename</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.class_handles_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.class_handles_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude DDB.nc files. Override base class.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbRobot.get_dataframe_at_qpoint">
<code class="descname">get_dataframe_at_qpoint</code><span class="sig-paren">(</span><em>qpoint=None</em>, <em>asr=2</em>, <em>chneut=1</em>, <em>dipdip=1</em>, <em>with_geo=True</em>, <em>abspath=False</em>, <em>funcs=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.get_dataframe_at_qpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.get_dataframe_at_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Call anaddb to compute the phonon frequencies at a single q-point using the DDB files treated
by the robot and the given anaddb input arguments.
Build and return a pandas dataframe with results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qpoint</strong> – Reduced coordinates of the qpoint where phonon modes are computed</li>
<li><strong>chneut</strong><strong>, </strong><strong>dipdp</strong> (<em>asr</em><em>,</em>) – Anaddb input variable. See official documentation.</li>
<li><strong>with_geo</strong> – True if structure info should be added to the dataframe</li>
<li><strong>abspath</strong> – True if paths in index should be absolute. Default: Relative to getcwd().</li>
<li><strong>funcs</strong> – Function or list of functions to execute to add more data to the DataFrame.
Each function receives a <a class="reference internal" href="#abipy.dfpt.ddb.DdbFile" title="abipy.dfpt.ddb.DdbFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.ddb.DdbFile</span></code></a> object and returns a tuple (key, value)
where key is a string with the name of column and value is the value to be inserted.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0.dev0+427.gee9c7e9.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbRobot.anaget_phonon_plotters">
<code class="descname">anaget_phonon_plotters</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.anaget_phonon_plotters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.anaget_phonon_plotters" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke anaddb to compute phonon bands and DOS using the arguments passed via **kwargs.
Collect results and return <cite>namedtuple</cite> with the following attributes:</p>
<blockquote>
<div>phbands_plotter: <a class="reference internal" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="abipy.dfpt.phonons.PhononBandsPlotter"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhononBandsPlotter</span></code></a> object.
phdos_plotter: <a class="reference internal" href="#abipy.dfpt.phonons.PhononDosPlotter" title="abipy.dfpt.phonons.PhononDosPlotter"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhononDosPlotter</span></code></a> object.</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.ddb.DdbRobot.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.gruneisen">
<span id="gruneisen-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">gruneisen</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.gruneisen" title="Permalink to this headline">¶</a></h2>
<p>Objects to analyze the results stored in the GRUNS.nc file produced by anaddb.</p>
<dl class="class">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile">
<em class="property">class </em><code class="descclassname">abipy.dfpt.gruneisen.</code><code class="descname">GrunsNcFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>This object provides an interface to the <code class="docutils literal"><span class="pre">GRUNS.nc</span></code> file produced by abinit.
This file contains Grunesein parameters computed via finite difference.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">GrunsNcFile</span><span class="p">(</span><span class="s2">&quot;foo_GRUNS.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-788afa0663b8feac06ddc695761a565bb50055a4.png" alt="Inheritance diagram of GrunsNcFile" usemap="#inheritance5d50b201b3" class="inheritance"/>
<map id="inheritance5d50b201b3" name="inheritance5d50b201b3">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="16,5,214,29"/>
<area shape="rect" id="node4" href="#abipy.dfpt.gruneisen.GrunsNcFile" target="_top" title="This object provides an interface to the ``GRUNS.nc`` file produced by abinit." alt="" coords="273,53,491,77"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="9,53,221,77"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,101,225,125"/>
</map>
<dl class="classmethod">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> corresponding to the central point V0.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.iv0">
<code class="descname">iv0</code><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.iv0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.doses">
<code class="descname">doses</code><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.doses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.doses" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the phonon doses.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.phbands_qpath_vol">
<code class="descname">phbands_qpath_vol</code><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.phbands_qpath_vol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.phbands_qpath_vol" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> objects corresponding to the different volumes.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.to_dataframe">
<code class="descname">to_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.to_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0.dev0+427.gee9c7e9.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with the following columns:</p>
<blockquote>
<div>[‘qidx’, ‘mode’, ‘freq’, ‘qpoint’]</div></blockquote>
<p>where:</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Column</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>qidx</td>
<td>q-point index.</td>
</tr>
<tr class="row-odd"><td>mode</td>
<td>phonon branch index.</td>
</tr>
<tr class="row-even"><td>grun</td>
<td>Gruneisen parameter.</td>
</tr>
<tr class="row-odd"><td>groupv</td>
<td>Group velocity.</td>
</tr>
<tr class="row-even"><td>freq</td>
<td>Phonon frequency in eV.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.plot_doses">
<code class="descname">plot_doses</code><span class="sig-paren">(</span><em>xlims=None</em>, <em>dos_names='all'</em>, <em>with_idos=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.plot_doses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.plot_doses" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the different doses stored in the GRUNS.nc file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>xlims</strong> – Set the data limits for the x-axis in eV. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>dos_names</strong> – List of strings defining the DOSes to plot. Use “all” to plot all DOSes available.</li>
<li><strong>with_idos</strong> – True to display integrated doses.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.get_plotter">
<code class="descname">get_plotter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.get_plotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.get_plotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="abipy.dfpt.phonons.PhononBandsPlotter"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhononBandsPlotter</span></code></a> that can be use to plot
multiple phonon bands or animate the bands</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.plot_phbands_with_gruns">
<code class="descname">plot_phbands_with_gruns</code><span class="sig-paren">(</span><em>fill_with='gruns'</em>, <em>gamma_fact=1</em>, <em>alpha=0.6</em>, <em>with_doses='all'</em>, <em>units='eV'</em>, <em>ylims=None</em>, <em>match_bands=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.plot_phbands_with_gruns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.plot_phbands_with_gruns" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon bands corresponding to <code class="docutils literal"><span class="pre">V0</span></code> (the central point) with markers
showing the value and the sign of the Grunesein parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fill_with</strong> – Define the quantity used to plot stripes. “gruns” for Grunesein parameters,
“groupv” for phonon group velocities.</li>
<li><strong>gamma_fact</strong> – Scaling factor for Grunesein parameters.
Up triangle for positive values, down triangles for negative values.</li>
<li><strong>alpha</strong> – The alpha blending value for the markers between 0 (transparent) and 1 (opaque).</li>
<li><strong>with_doses</strong> – “all” to plot all DOSes available, <code class="docutils literal"><span class="pre">None</span></code> to disable DOS plotting,
else list of strings with the name of the DOSes to plot.</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis in eV. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>match_bands</strong> – if True tries to follow the band along the path based on the scalar product of the eigenvectors.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.gruneisen.GrunsReader">
<em class="property">class </em><code class="descclassname">abipy.dfpt.gruneisen.</code><code class="descname">GrunsReader</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads the results stored in the GRUNS.nc file produced by ABINIT.
It provides helper functions to access the most important quantities.</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-f8f984882578c5a3e3dd3dbdd119fe8507aa4f3c.png" alt="Inheritance diagram of GrunsReader" usemap="#inheritanced0ee4d5629" class="inheritance"/>
<map id="inheritanced0ee4d5629" name="inheritanced0ee4d5629">
<area shape="rect" id="node1" href="#abipy.dfpt.gruneisen.GrunsReader" target="_top" title="This object reads the results stored in the GRUNS.nc file produced by ABINIT." alt="" coords="604,4,764,21"/>
<area shape="rect" id="node2" href="iotools_api.html#abipy.iotools.ETSF_Reader" target="_top" title="Provides high&#45;level API to read data from netcdf files written" alt="" coords="439,4,570,21"/>
<area shape="rect" id="node3" title="This object reads data from a file written according to the ETSF&#45;IO specifications." alt="" coords="220,4,405,21"/>
<area shape="rect" id="node4" title="Wraps and extends netCDF4.Dataset. Read only mode. Supports with statements." alt="" coords="4,4,186,21"/>
</map>
<dl class="method">
<dt id="abipy.dfpt.gruneisen.GrunsReader.read_doses">
<code class="descname">read_doses</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsReader.read_doses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsReader.read_doses" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pythonhosted.org/monty/monty.html#monty.collections.AttrDict" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal"><span class="pre">monty.collections.AttrDict</span></code></a> with the DOSes available in the file. Empty dict if
DOSes are not available.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.gruneisen.GrunsReader.read_phbands_on_qpath">
<code class="descname">read_phbands_on_qpath</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsReader.read_phbands_on_qpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsReader.read_phbands_on_qpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> computed at the different volumes.
The <code class="docutils literal"><span class="pre">iv0</span></code> entry corresponds to the central point used to compute Grunesein parameters
with finite differences. This object stores the Grunesein parameters in <code class="docutils literal"><span class="pre">grun_vals</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.gruneisen.GrunsReader.read_amuz_dict">
<code class="descname">read_amuz_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsReader.read_amuz_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsReader.read_amuz_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary that associates the atomic number to the values of the atomic
mass units used for the calculation.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.phonons">
<span id="phonons-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">phonons</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.phonons" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="abipy.dfpt.phonons.PhononBands">
<em class="property">class </em><code class="descclassname">abipy.dfpt.phonons.</code><code class="descname">PhononBands</code><span class="sig-paren">(</span><em>structure</em>, <em>qpoints</em>, <em>phfreqs</em>, <em>phdispl_cart</em>, <em>non_anal_ph=None</em>, <em>amu=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Container object storing the phonon band structure.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Frequencies are in eV. Cartesian displacements are in Angstrom.</p>
</div>
<dl class="classmethod">
<dt id="abipy.dfpt.phonons.PhononBands.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.dfpt.phonons.PhononBands.as_phbands">
<em class="property">classmethod </em><code class="descname">as_phbands</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.as_phbands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.as_phbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> from a generic object <code class="docutils literal"><span class="pre">obj</span></code>.
Supports:</p>
<blockquote>
<div><ul class="simple">
<li>instances of cls</li>
<li>files (string) that can be open with <code class="docutils literal"><span class="pre">abiopen</span></code> and that provide a <code class="docutils literal"><span class="pre">phbands</span></code> attribute.</li>
<li>objects providing a <code class="docutils literal"><span class="pre">phbands</span></code> attribute.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.dfpt.phonons.PhononBands.factor_ev2units">
<em class="property">static </em><code class="descname">factor_ev2units</code><span class="sig-paren">(</span><em>units</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.factor_ev2units"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.factor_ev2units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return conversion factor eV –&gt; units (case-insensitive)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.read_non_anal_from_file">
<code class="descname">read_non_anal_from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.read_non_anal_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.read_non_anal_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the non analytical directions, frequencies and eigendisplacements from the anaddb.nc file
specified and adds them to the object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>title=None</em>, <em>with_structure=True</em>, <em>with_qpoints=False</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Human-readable string with useful information such as structure, q-points, …</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>with_structure</strong> – False if structural info should not be displayed.</li>
<li><strong>with_qpoints</strong> – False if q-point info shoud not be displayed.</li>
<li><strong>verbose</strong> – Verbosity level.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.displ_shape">
<code class="descname">displ_shape</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.displ_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of phdispl_cart.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.minfreq">
<code class="descname">minfreq</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.minfreq" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum phonon frequency.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.maxfreq">
<code class="descname">maxfreq</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.maxfreq" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum phonon frequency.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.get_minfreq_mode">
<code class="descname">get_minfreq_mode</code><span class="sig-paren">(</span><em>mode=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_minfreq_mode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_minfreq_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the minimum of the frequencies.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.get_maxfreq_mode">
<code class="descname">get_maxfreq_mode</code><span class="sig-paren">(</span><em>mode=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_maxfreq_mode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_maxfreq_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the minimum of the frequencies.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.shape">
<code class="descname">shape</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape of the array with the eigenvalues.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.dyn_mat_eigenvect">
<code class="descname">dyn_mat_eigenvect</code><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.dyn_mat_eigenvect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.dyn_mat_eigenvect" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigenvalues of the dynamical matrix.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.non_anal_directions">
<code class="descname">non_anal_directions</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.non_anal_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian directions along which the non analytical frequencies and displacements are available</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.non_anal_phfreqs">
<code class="descname">non_anal_phfreqs</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.non_anal_phfreqs" title="Permalink to this definition">¶</a></dt>
<dd><p>Phonon frequencies with non analytical contribution in eV along non_anal_directions</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.non_anal_phdispl_cart">
<code class="descname">non_anal_phdispl_cart</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.non_anal_phdispl_cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Displacement in Cartesian coordinates with non analytical contribution along non_anal_directions</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.non_anal_dyn_mat_eigenvect">
<code class="descname">non_anal_dyn_mat_eigenvect</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.non_anal_dyn_mat_eigenvect" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigenvalues of the dynamical matrix with non analytical contribution along non_anal_directions.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.to_xmgrace">
<code class="descname">to_xmgrace</code><span class="sig-paren">(</span><em>filepath</em>, <em>units='meV'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.to_xmgrace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.to_xmgrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <a class="reference external" href="http://plasma-gate.weizmann.ac.il/Grace/">xmgrace</a> file with phonon band structure energies and labels for high-symmetry q-points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filepath</strong> – String with filename or stream.</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.qindex">
<code class="descname">qindex</code><span class="sig-paren">(</span><em>qpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.qindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.qindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of the qpoint. Accepts integer or reduced coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.qindex_qpoint">
<code class="descname">qindex_qpoint</code><span class="sig-paren">(</span><em>qpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.qindex_qpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.qindex_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (qindex, qpoint) from an integer or a qpoint.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.get_unstable_modes">
<code class="descname">get_unstable_modes</code><span class="sig-paren">(</span><em>below_mev=-5.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_unstable_modes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_unstable_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of <code class="xref py py-class docutils literal"><span class="pre">PhononMode</span></code> objects with the unstable modes.
A mode is unstable if its frequency is &lt; below_mev. Output list is sorted
and modes with lowest frequency come first.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.get_dict4pandas">
<code class="descname">get_dict4pandas</code><span class="sig-paren">(</span><em>with_spglib=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_dict4pandas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_dict4pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with the most important parameters:</p>
<blockquote>
<div><ul class="simple">
<li>Chemical formula and number of atoms.</li>
<li>Lattice lengths, angles and volume.</li>
<li>The spacegroup number computed by Abinit (set to None if not available).</li>
<li>The spacegroup number and symbol computed by spglib (set to None not <cite>with_spglib</cite>).</li>
</ul>
</div></blockquote>
<p>Useful to construct pandas DataFrames</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>with_spglib</strong> – If True, <a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> is invoked to get the spacegroup symbol and number</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.get_phdos">
<code class="descname">get_phdos</code><span class="sig-paren">(</span><em>method='gaussian'</em>, <em>step=0.0001</em>, <em>width=0.0004</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_phdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the phonon DOS on a linear mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> – String defining the method</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a> object.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Requires a homogeneous sampling of the Brillouin zone.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.create_xyz_vib">
<code class="descname">create_xyz_vib</code><span class="sig-paren">(</span><em>iqpt</em>, <em>filename</em>, <em>pre_factor=200</em>, <em>do_real=True</em>, <em>scale_matrix=None</em>, <em>max_supercell=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.create_xyz_vib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.create_xyz_vib" title="Permalink to this definition">¶</a></dt>
<dd><p>Create vibration XYZ file for visualization of phonons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iqpt</strong> – index of qpoint in self</li>
<li><strong>filename</strong> – name of the XYZ file that will be created</li>
<li><strong>pre_factor</strong> – Multiplication factor of the eigendisplacements</li>
<li><strong>do_real</strong> – True if we want only real part of the displacement, False means imaginary part</li>
<li><strong>scale_matrix</strong> – Scaling matrix of the supercell</li>
<li><strong>max_supercell</strong> – Maximum size of the supercell with respect to primitive cell</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.create_ascii_vib">
<code class="descname">create_ascii_vib</code><span class="sig-paren">(</span><em>iqpts</em>, <em>filename</em>, <em>pre_factor=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.create_ascii_vib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.create_ascii_vib" title="Permalink to this definition">¶</a></dt>
<dd><p>Create vibration ascii file for visualization of phonons.
This format can be read with <a class="reference external" href="http://inac.cea.fr/L_Sim/V_Sim/">v_sim</a> or ascii-phonons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iqpts</strong> – an index or a list of indices of the qpoints in self. Note that at present only V_sim supports
an ascii file with multiple qpoints.</li>
<li><strong>filename</strong> – name of the ascii file that will be created.</li>
<li><strong>pre_factor</strong> – Multiplication factor of the eigendisplacements.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.view_phononwebsite">
<code class="descname">view_phononwebsite</code><span class="sig-paren">(</span><em>browser=None</em>, <em>verbose=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.view_phononwebsite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.view_phononwebsite" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce <a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a> file that can be parsed from the phononwebsite and open it in <code class="docutils literal"><span class="pre">browser</span></code>.</p>
<p>Return: Exit status</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.create_phononwebsite_json">
<code class="descname">create_phononwebsite_json</code><span class="sig-paren">(</span><em>filename</em>, <em>name=None</em>, <em>repetitions=None</em>, <em>highsym_qpts=None</em>, <em>match_bands=True</em>, <em>highsym_qpts_mode='split'</em>, <em>indent=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.create_phononwebsite_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.create_phononwebsite_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a> file that can be parsed from the <a class="reference external" href="http://henriquemiranda.github.io/phononwebsite/">phononwebsite</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> – name of the json file that will be created</li>
<li><strong>name</strong> – name associated with the data.</li>
<li><strong>repetitions</strong> – number of repetitions of the cell. List of three integers. Defaults to [3,3,3].</li>
<li><strong>highsym_qpts</strong> – list of tuples. The first element of each tuple should be a list with the coordinates
of a high symmetry point, the second element of the tuple should be its label.</li>
<li><strong>match_bands</strong> – if True tries to follow the band along the path based on the scalar product of the eigenvectors.</li>
<li><strong>highsym_qpts_mode</strong> – if highsym_qpts is None high symmetry q-points can be automatically determined.
Accepts the following values:
‘split’ will split the path based on points where the path changes direction in the Brillouin zone.
Similar to the what is done in phononwebsite. Only Gamma will be labeled.
‘std’ uses the standard generation procedure for points and labels used in PhononBands.
None does not set any point.</li>
<li><strong>indent</strong> – Indentation level, passed to json.dump</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.decorate_ax">
<code class="descname">decorate_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>units='eV'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.decorate_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.decorate_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Add k-labels, title and unit name to axis ax.
Use units = “” to add k-labels without adding unit name.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>units='eV'</em>, <em>qlabels=None</em>, <em>branch_range=None</em>, <em>match_bands=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon band structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</li>
<li><strong>branch_range</strong> – Tuple specifying the minimum and maximum branch index to plot (default: all branches are plotted).</li>
<li><strong>match_bands</strong> – if True the bands will be matched based on the scalar product between the eigenvectors.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_ax">
<code class="descname">plot_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>branch</em>, <em>units='eV'</em>, <em>match_bands=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the frequencies for the given branches indices as a function of the q-index on axis <code class="docutils literal"><span class="pre">ax</span></code>.
If <code class="docutils literal"><span class="pre">branch</span></code> is None, all phonon branches are plotted.</p>
<p>Return: The list of matplotlib lines added.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_colored_matched">
<code class="descname">plot_colored_matched</code><span class="sig-paren">(</span><em>ax=None</em>, <em>units='eV'</em>, <em>qlabels=None</em>, <em>branch_range=None</em>, <em>colormap='rainbow'</em>, <em>max_colors=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_colored_matched"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_colored_matched" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon band structure with different color for each line.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</li>
<li><strong>branch_range</strong> – Tuple specifying the minimum and maximum branch_i index to plot
(default: all branches are plotted).</li>
<li><strong>colormap</strong> – matplotlib colormap to determine the colors available. The colors will be chosen not in a
sequential order to avoid difficulties in distinguishing the lines.
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a></li>
<li><strong>max_colors</strong> – maximum number of colors to be used. If max_colors &lt; num_braches the colors will be reapeated.
It useful to better distinguish close bands when the number of branch is large.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.split_qpoints">
<code class="descname">split_qpoints</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.split_qpoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.split_phfreqs">
<code class="descname">split_phfreqs</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.split_phfreqs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.split_phdispl_cart">
<code class="descname">split_phdispl_cart</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.split_phdispl_cart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBands.split_matched_indices">
<code class="descname">split_matched_indices</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.split_matched_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of numpy arrays containing the indices in which each band should be sorted in order to match the
scalar product of the eigenvectors. The shape is the same as that of split_phfreqs.
Lazy property.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_fatbands">
<code class="descname">plot_fatbands</code><span class="sig-paren">(</span><em>units='eV'</em>, <em>colormap='jet'</em>, <em>phdos_file=None</em>, <em>alpha=0.7</em>, <em>max_stripe_width_mev=3.0</em>, <em>width_ratios=(2</em>, <em>1)</em>, <em>qlabels=None</em>, <em>ylims=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_fatbands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_fatbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot phonon fatbands and, optionally, atom-projected DOSes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>colormap</strong> – Have a look at the colormaps here and decide which one you like:
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a></li>
<li><strong>phdos_file</strong> – Used to activate fatbands + PJDOS plot.
Accept string with path of PHDOS.nc file or <a class="reference internal" href="#abipy.dfpt.phonons.PhdosFile" title="abipy.dfpt.phonons.PhdosFile"><code class="xref py py-class docutils literal"><span class="pre">PhdosFile</span></code></a> object.</li>
<li><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque)</li>
<li><strong>max_stripe_width_mev</strong> – The maximum width of the stripe in meV. Will be rescaled according to <cite>units</cite>.</li>
<li><strong>width_ratios</strong> – Ratios between the width of the fatbands plots and the DOS plots.
Used if <cite>phdos_file</cite> is not None</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</li>
<li><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</li>
<li><strong>fontsize</strong> – Legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_with_phdos">
<code class="descname">plot_with_phdos</code><span class="sig-paren">(</span><em>phdos</em>, <em>units='eV'</em>, <em>qlabels=None</em>, <em>axlist=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_with_phdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_with_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon band structure with the phonon DOS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phdos</strong> – An instance of <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal"><span class="pre">PhononDos</span></code></a> or a netcdf file providing a PhononDos object.</li>
<li><strong>units</strong> – Units for plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels e.g. <code class="docutils literal"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</li>
<li><strong>axlist</strong> – The axes for the bandstructure plot and the DOS plot. If axlist is None, a new figure
is created and the two axes are automatically generated.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.get_dataframe">
<code class="descname">get_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0.dev0+427.gee9c7e9.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with the following columns:</p>
<blockquote>
<div>[‘qidx’, ‘mode’, ‘freq’, ‘qpoint’]</div></blockquote>
<p>where:</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Column</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>qidx</td>
<td>q-point index.</td>
</tr>
<tr class="row-odd"><td>mode</td>
<td>phonon branch index.</td>
</tr>
<tr class="row-even"><td>freq</td>
<td>Phonon frequency in eV.</td>
</tr>
<tr class="row-odd"><td>qpoint</td>
<td><code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.boxplot">
<code class="descname">boxplot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>units='eV'</em>, <em>mode_range=None</em>, <em>swarm=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.boxplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.boxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot to show distributions of eigenvalues with respect to the mode index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>mode_range</strong> – Only modes such as <cite>mode_range[0] &lt;= mode_index &lt; mode_range[1]</cite> are included in the plot.</li>
<li><strong>swarm</strong> – True to show the datapoints on top of the boxes</li>
<li><strong>kwargs</strong> – Keyword arguments passed to seaborn boxplot.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBands.to_pymatgen">
<code class="descname">to_pymatgen</code><span class="sig-paren">(</span><em>qlabels=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.to_pymatgen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.to_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a pymatgen <code class="xref py py-class docutils literal"><span class="pre">PhononBandStructureSymmLine</span></code> object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels e.g. <code class="docutils literal"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):&quot;L&quot;}</span></code>.
If None labels will be determined automatically.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.phonons.PhbstFile">
<em class="property">class </em><code class="descclassname">abipy.dfpt.phonons.</code><code class="descname">PhbstFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_PhononBands" title="abipy.core.mixins.Has_PhononBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_PhononBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Object used to access data stored in the PHBST.nc file produced by ABINIT.</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-e9bb91df985ceb0c58f23594d7e88601a2a3e453.png" alt="Inheritance diagram of PhbstFile" usemap="#inheritancee7492c30a8" class="inheritance"/>
<map id="inheritancee7492c30a8" name="inheritancee7492c30a8">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="27,5,225,29"/>
<area shape="rect" id="node5" href="#abipy.dfpt.phonons.PhbstFile" target="_top" title="Object used to access data stored in the PHBST.nc file produced by ABINIT." alt="" coords="295,77,488,101"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.Has_PhononBands" target="_top" title="Mixin class for :class:`AbinitNcFile` containing phonon data." alt="" coords="5,53,247,77"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="20,101,232,125"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="17,149,236,173"/>
</map>
<dl class="method">
<dt id="abipy.dfpt.phonons.PhbstFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> – verbosity level.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhbstFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhbstFile.qpoints">
<code class="descname">qpoints</code><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>List of q-point objects.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhbstFile.phbands">
<code class="descname">phbands</code><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.phbands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> object</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhbstFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhbstFile.qindex">
<code class="descname">qindex</code><span class="sig-paren">(</span><em>qpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.qindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.qindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of the qpoint. Accepts integer or reduced coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhbstFile.qindex_qpoint">
<code class="descname">qindex_qpoint</code><span class="sig-paren">(</span><em>qpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.qindex_qpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.qindex_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (qindex, qpoint) from an integer or a qpoint.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhbstFile.get_phframe">
<code class="descname">get_phframe</code><span class="sig-paren">(</span><em>qpoint</em>, <em>with_structure=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.get_phframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.get_phframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0.dev0+427.gee9c7e9.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with the phonon frequencies at the given q-point and
information on the crystal structure (used for convergence studies).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qpoint</strong> – integer, vector of reduced coordinates or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</li>
<li><strong>with_structure</strong> – True to add structural parameters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhbstFile.get_phmode">
<code class="descname">get_phmode</code><span class="sig-paren">(</span><em>qpoint</em>, <em>branch</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.get_phmode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.get_phmode" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="xref py py-class docutils literal"><span class="pre">PhononMode</span></code> with the given qpoint and branch nu.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qpoint</strong> – Either a vector with the reduced components of the q-point
or an integer giving the sequential index (C-convention).</li>
<li><strong>branch</strong> – branch index (C-convention)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal"><span class="pre">PhononMode</span></code> instance.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhbstFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.phonons.PhononDos">
<em class="property">class </em><code class="descclassname">abipy.dfpt.phonons.</code><code class="descname">PhononDos</code><span class="sig-paren">(</span><em>mesh</em>, <em>values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a></p>
<p>This object stores the phonon density of states.
An instance of <code class="docutils literal"><span class="pre">PhononDos</span></code> has a <code class="docutils literal"><span class="pre">mesh</span></code> (numpy array with the points of the mesh)
and another numpy array, <code class="docutils literal"><span class="pre">values</span></code>, with the DOS on the mesh.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">mesh is given in eV, values are in states/eV.</p>
</div>
<dl class="classmethod">
<dt id="abipy.dfpt.phonons.PhononDos.as_phdos">
<em class="property">classmethod </em><code class="descname">as_phdos</code><span class="sig-paren">(</span><em>obj</em>, <em>phdos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.as_phdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.as_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <code class="xref py py-class docutils literal"><span class="pre">PhononDOS</span></code> from a generic obj. Supports:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>- instances of cls
- files (string) that can be open with abiopen and that provide one of the following attributes: [`phdos`, `phbands`]
- instances of ``PhononBands`
- objects providing a ``phbands`` attribute.
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phdos_kwargs</strong> – optional dictionary with the options passed to <code class="docutils literal"><span class="pre">get_phdos</span></code> to compute the phonon DOS.</li>
<li><strong>when obj is not already an instance of cls</strong><strong> or </strong><strong>when we have to compute the DOS from obj.</strong> (<em>Used</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononDos.iw0">
<code class="descname">iw0</code><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.iw0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.iw0" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the first point in the mesh whose value is &gt;= 0</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononDos.idos">
<code class="descname">idos</code><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.idos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.idos" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrated DOS.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononDos.zero_point_energy">
<code class="descname">zero_point_energy</code><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.zero_point_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.zero_point_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Zero point energy in eV per unit cell.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDos.plot_dos_idos">
<code class="descname">plot_dos_idos</code><span class="sig-paren">(</span><em>ax</em>, <em>what='d'</em>, <em>exchange_xy=False</em>, <em>units='eV'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.plot_dos_idos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.plot_dos_idos" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot DOS/IDOS on the axis <code class="docutils literal"><span class="pre">ax</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a></li>
<li><strong>what</strong> – string selecting the quantity to plot:
“d” for DOS, “i” for IDOS. chars can be concatenated
hence what=”id” plots both IDOS and DOS. (default “d”).</li>
<li><strong>exchange_xy</strong> – True to exchange axis</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>kwargs</strong> – Options passed to matplotlib plot method.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of lines added to the plot.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDos.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>units='eV'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Phonon DOS and IDOS on two distict plots.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>kwargs</strong> – Keyword arguments passed to <code class="xref py py-mod docutils literal"><span class="pre">matplotlib</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDos.get_internal_energy">
<code class="descname">get_internal_energy</code><span class="sig-paren">(</span><em>tstart=5</em>, <em>tstop=300</em>, <em>num=50</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.get_internal_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.get_internal_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the internal energy, in eV, in the harmonic approximation for different temperatures
Zero point energy is included.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</li>
<li><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</li>
<li><strong>num</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – optional Number of samples to generate. Default is 50.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object with U(T) + ZPE.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDos.get_entropy">
<code class="descname">get_entropy</code><span class="sig-paren">(</span><em>tstart=5</em>, <em>tstop=300</em>, <em>num=50</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.get_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.get_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the entropy, in eV/K, in the harmonic approximation for different temperatures</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</li>
<li><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</li>
<li><strong>num</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – optional Number of samples to generate. Default is 50.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object with S(T).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDos.get_free_energy">
<code class="descname">get_free_energy</code><span class="sig-paren">(</span><em>tstart=5</em>, <em>tstop=300</em>, <em>num=50</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.get_free_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.get_free_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the free energy, in eV, in the harmonic approximation for different temperatures
Zero point energy is included.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</li>
<li><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</li>
<li><strong>num</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – optional Number of samples to generate. Default is 50.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object with F(T) = U(T) + ZPE - T x S(T)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDos.get_cv">
<code class="descname">get_cv</code><span class="sig-paren">(</span><em>tstart=5</em>, <em>tstop=300</em>, <em>num=50</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.get_cv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.get_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the constant-volume specific heat, in eV/K, in the harmonic approximation
for different temperatures</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</li>
<li><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</li>
<li><strong>num</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – optional Number of samples to generate. Default is 50.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object with C_v(T).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDos.plot_harmonic_thermo">
<code class="descname">plot_harmonic_thermo</code><span class="sig-paren">(</span><em>tstart=5</em>, <em>tstop=300</em>, <em>num=50</em>, <em>units='eV'</em>, <em>formula_units=None</em>, <em>quantities=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.plot_harmonic_thermo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.plot_harmonic_thermo" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot thermodinamic properties from the phonon DOSes within the harmonic approximation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</li>
<li><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</li>
<li><strong>num</strong> – int, optional Number of samples to generate. Default is 50.</li>
<li><strong>quantities</strong> – List of strings specifying the thermodinamic quantities to plot.
Possible values: [“internal_energy”, “free_energy”, “entropy”, “c_v”].
None means all.</li>
<li><strong>units</strong> – eV for energies in ev/unit_cell, Jmol for results in J/mole.</li>
<li><strong>formula_units</strong> – the number of formula units per unit cell. If unspecified, the
thermodynamic quantities will be given on a per-unit-cell basis.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDos.to_pymatgen">
<code class="descname">to_pymatgen</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.to_pymatgen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.to_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a pymatgen <code class="xref py py-class docutils literal"><span class="pre">PmgPhononDos</span></code> object</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.phonons.PhdosReader">
<em class="property">class </em><code class="descclassname">abipy.dfpt.phonons.</code><code class="descname">PhdosReader</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads data from the PHDOS.nc file produced by anaddb.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Frequencies are in eV, DOSes are in states/eV.</p>
</div>
<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhdosReader.structure">
<code class="descname">structure</code><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhdosReader.wmesh">
<code class="descname">wmesh</code><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.wmesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.wmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>The frequency mesh for the PH-DOS in eV.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_pjdos_type">
<code class="descname">read_pjdos_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_pjdos_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_pjdos_type" title="Permalink to this definition">¶</a></dt>
<dd><p>[ntypat, nomega] array with PH-DOS projected over atom types.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_pjdos_atdir">
<code class="descname">read_pjdos_atdir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_pjdos_atdir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_pjdos_atdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Return [natom, three, nomega] array with Phonon DOS projected over atoms and reduced directions.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_phdos">
<code class="descname">read_phdos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_phdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <code class="xref py py-class docutils literal"><span class="pre">PhononDOS</span></code>. with the total phonon DOS</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_pjdos_symbol_rc_dict">
<code class="descname">read_pjdos_symbol_rc_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_pjdos_symbol_rc_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_pjdos_symbol_rc_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> mapping element symbol –&gt; [3, nomega] array
with the the phonon DOSes summed over atom-types and decomposed along
the three reduced directions.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_pjdos_symbol_dict">
<code class="descname">read_pjdos_symbol_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_pjdos_symbol_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_pjdos_symbol_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered dictionary mapping element symbol –&gt; <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal"><span class="pre">PhononDos</span></code></a>
where PhononDos is the contribution to the total DOS summed over atoms
with chemical symbol <code class="docutils literal"><span class="pre">symbol</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.phonons.PhdosFile">
<em class="property">class </em><code class="descclassname">abipy.dfpt.phonons.</code><code class="descname">PhdosFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Container object storing the different DOSes stored in the
PHDOS.nc file produced by anaddb.
Provides helper function to visualize/extract data.</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-dada176e574950230a30d768df86ee7d316adc33.png" alt="Inheritance diagram of PhdosFile" usemap="#inheritance39e463df1c" class="inheritance"/>
<map id="inheritance39e463df1c" name="inheritance39e463df1c">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="16,5,214,29"/>
<area shape="rect" id="node4" href="#abipy.dfpt.phonons.PhdosFile" target="_top" title="Container object storing the different DOSes stored in the" alt="" coords="273,53,469,77"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="9,53,221,77"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,101,225,125"/>
</map>
<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Human-readable string with useful information such as structure…</p>
<blockquote>
<div>verbose: Verbosity level.</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhdosFile.structure">
<code class="descname">structure</code><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhdosFile.phdos">
<code class="descname">phdos</code><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.phdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.phdos" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal"><span class="pre">PhononDos</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhdosFile.pjdos_symbol">
<code class="descname">pjdos_symbol</code><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.pjdos_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.pjdos_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered dictionary mapping element symbol –&gt; <cite>PhononDos</cite>
where PhononDos is the contribution to the total DOS summed over atoms
with chemical symbol <cite>symbol</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosFile.plot_pjdos_type">
<code class="descname">plot_pjdos_type</code><span class="sig-paren">(</span><em>units='eV'</em>, <em>stacked=True</em>, <em>colormap='jet'</em>, <em>alpha=0.7</em>, <em>ax=None</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.plot_pjdos_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.plot_pjdos_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot type-projected phonon DOS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>colormap</strong> – Have a look at the colormaps
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">here</a>
and decide which one you’d like:</li>
<li><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque).</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used.</li>
<li><strong>ylims</strong> – y-axis limits.</li>
<li><strong>fontsize</strong> – legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosFile.plot_pjdos_redirs_type">
<code class="descname">plot_pjdos_redirs_type</code><span class="sig-paren">(</span><em>units='eV'</em>, <em>stacked=True</em>, <em>colormap='jet'</em>, <em>alpha=0.7</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>axlist=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.plot_pjdos_redirs_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.plot_pjdos_redirs_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot type-projected phonon DOS decomposed along the three reduced directions.
Three rows for each reduced direction. Each row shows the contribution of each atomic type + Total Phonon DOS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</li>
<li><strong>colormap</strong> – <p>Have a look at the colormaps
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">here</a>
and decide which one you’d like:</p>
</li>
<li><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque)</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>ylims</strong> – y-axis limits.</li>
<li><strong>axlist</strong> – List of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>fontsize</strong> – Legend and label fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosFile.plot_pjdos_redirs_site">
<code class="descname">plot_pjdos_redirs_site</code><span class="sig-paren">(</span><em>view='inequivalent'</em>, <em>units='eV'</em>, <em>stacked=True</em>, <em>colormap='jet'</em>, <em>alpha=0.7</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>axlist=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.plot_pjdos_redirs_site"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.plot_pjdos_redirs_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot phonon PJDOS for each atom in the unit cell. By default, only “inequivalent” atoms are shown.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>view</strong> – “inequivalent”, “all”</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</li>
<li><strong>colormap</strong> – matplotlib colormap.</li>
<li><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque)</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>axlist</strong> – List of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>fontsize</strong> – Legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhdosFile.to_pymatgen">
<code class="descname">to_pymatgen</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.to_pymatgen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.to_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a pymatgen <code class="xref py py-class docutils literal"><span class="pre">PmgCompletePhononDos</span></code> object.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter">
<em class="property">class </em><code class="descclassname">abipy.dfpt.phonons.</code><code class="descname">PhononBandsPlotter</code><span class="sig-paren">(</span><em>key_phbands=None</em>, <em>key_phdos=None</em>, <em>phdos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Class for plotting phonon band structure and DOSes.
Supports plots on the same graph or separated plots.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">PhononBandsPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_phbands</span><span class="p">(</span><span class="s2">&quot;foo bands&quot;</span><span class="p">,</span> <span class="s2">&quot;foo_PHBST.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_phbands</span><span class="p">(</span><span class="s2">&quot;bar bands&quot;</span><span class="p">,</span> <span class="s2">&quot;bar_PHBST.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">gridplot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.add_plotter">
<code class="descname">add_plotter</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.add_plotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.add_plotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge two plotters, return new plotter.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>func=&lt;class 'str'&gt;</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.get_phbands_frame">
<code class="descname">get_phbands_frame</code><span class="sig-paren">(</span><em>with_spglib=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.get_phbands_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.get_phbands_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0.dev0+427.gee9c7e9.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with the most important results available in the band structures.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.phbands_dict">
<code class="descname">phbands_dict</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.phbands_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the mapping label –&gt; phbands.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.bands_dict">
<code class="descname">bands_dict</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.bands_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the mapping label –&gt; phbands.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.phdoses_dict">
<code class="descname">phdoses_dict</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.phdoses_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the mapping label –&gt; phdos.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.phbands_list">
<code class="descname">phbands_list</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.phbands_list" title="Permalink to this definition">¶</a></dt>
<dd><p>“List of ` – class – PhononBands`.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.phdoses_list">
<code class="descname">phdoses_list</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.phdoses_list" title="Permalink to this definition">¶</a></dt>
<dd><p>“List of <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal"><span class="pre">PhononDos</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.iter_lineopt">
<code class="descname">iter_lineopt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.iter_lineopt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.iter_lineopt" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates style options for lines.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.add_phbands_from_file">
<code class="descname">add_phbands_from_file</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.add_phbands_from_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.add_phbands">
<code class="descname">add_phbands</code><span class="sig-paren">(</span><em>label</em>, <em>bands</em>, <em>phdos=None</em>, <em>dos=None</em>, <em>phdos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.add_phbands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.add_phbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a band structure for plotting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> – label for the bands. Must be unique.</li>
<li><strong>bands</strong> – <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal"><span class="pre">PhononBands</span></code></a> object.</li>
<li><strong>phdos</strong> – <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal"><span class="pre">PhononDos</span></code></a> object.</li>
<li><strong>phdos_kwargs</strong> – optional dictionary with the options passed to <code class="docutils literal"><span class="pre">get_phdos</span></code> to compute the phonon DOS.
Used only if <code class="docutils literal"><span class="pre">phdos</span></code> is not None.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.combiplot">
<code class="descname">combiplot</code><span class="sig-paren">(</span><em>qlabels=None</em>, <em>units='eV'</em>, <em>ylims=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.combiplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.combiplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure and the DOS on the same figure.
Use <code class="docutils literal"><span class="pre">gridplot</span></code> to plot band structures on different figures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the k-points.
The values are the labels e.g. <code class="docutils literal"><span class="pre">klabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for combiplot.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.gridplot">
<code class="descname">gridplot</code><span class="sig-paren">(</span><em>with_dos=True</em>, <em>units='eV'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.gridplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.gridplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot multiple electron bandstructures and optionally DOSes on a grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>with_dos</strong> – True if DOS should be printed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.boxplot">
<code class="descname">boxplot</code><span class="sig-paren">(</span><em>mode_range=None</em>, <em>units='eV'</em>, <em>swarm=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.boxplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.boxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot to show distributions of eigenvalues with respect to the band index.
Band structures are drawn on different subplots.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mode_range</strong> – Only bands such as <code class="docutils literal"><span class="pre">mode_range[0]</span> <span class="pre">&lt;=</span> <span class="pre">nu_index</span> <span class="pre">&lt;</span> <span class="pre">mode_range[1]</span></code> are included in the plot.</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>swarm</strong> – True to show the datapoints on top of the boxes</li>
<li><strong>kwargs</strong> – Keywork arguments passed to <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> boxplot.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.combiboxplot">
<code class="descname">combiboxplot</code><span class="sig-paren">(</span><em>mode_range=None</em>, <em>units='eV'</em>, <em>swarm=False</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.combiboxplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.combiboxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot comparing the distributions of the frequencies.
Phonon Band structures are drawn on the same plot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mode_range</strong> – Only bands such as <code class="docutils literal"><span class="pre">mode_range[0]</span> <span class="pre">&lt;=</span> <span class="pre">nu_index</span> <span class="pre">&lt;</span> <span class="pre">mode_range[1]</span></code> are included in the plot.</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>swarm</strong> – True to show the datapoints on top of the boxes</li>
<li><strong>ax</strong> – matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</li>
<li><strong>kwargs</strong> – Keyword arguments passed to <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> boxplot.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.animate">
<code class="descname">animate</code><span class="sig-paren">(</span><em>interval=500</em>, <em>savefile=None</em>, <em>units='eV'</em>, <em>width_ratios=(2</em>, <em>1)</em>, <em>show=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.animate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>Use matplotlib to animate a list of band structure plots (with or without DOS).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>interval</strong> – draws a new frame every interval milliseconds.</li>
<li><strong>savefile</strong> – Use e.g. ‘myanimation.mp4’ to save the animation in mp4 format.</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.
Used when there are DOS stored in the plotter.</li>
<li><strong>show</strong> – True if the animation should be shown immediately</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: Animation object.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="http://matplotlib.org/api/animation_api.html">http://matplotlib.org/api/animation_api.html</a>
<a class="reference external" href="http://jakevdp.github.io/blog/2012/08/18/matplotlib-animation-tutorial/">http://jakevdp.github.io/blog/2012/08/18/matplotlib-animation-tutorial/</a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It would be nice to animate the title of the plot, unfortunately
this feature is not available in the present version of matplotlib.
See: <a class="reference external" href="http://stackoverflow.com/questions/17558096/animated-title-in-matplotlib">http://stackoverflow.com/questions/17558096/animated-title-in-matplotlib</a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.ipw_select_plot">
<code class="descname">ipw_select_plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.ipw_select_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.ipw_select_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to select the plot.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.phonons.PhononDosPlotter">
<em class="property">class </em><code class="descclassname">abipy.dfpt.phonons.</code><code class="descname">PhononDosPlotter</code><span class="sig-paren">(</span><em>key_phdos=None</em>, <em>phdos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Class for plotting multiple phonon DOSes.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">PhononDosPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_phdos</span><span class="p">(</span><span class="s2">&quot;foo dos&quot;</span><span class="p">,</span> <span class="s2">&quot;foo.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_phdos</span><span class="p">(</span><span class="s2">&quot;bar dos&quot;</span><span class="p">,</span> <span class="s2">&quot;bar.nc&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">gridplot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.phdos_list">
<code class="descname">phdos_list</code><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.phdos_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List of phonon DOSes</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.add_phdos">
<code class="descname">add_phdos</code><span class="sig-paren">(</span><em>label</em>, <em>phdos</em>, <em>phdos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.add_phdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.add_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a DOS for plotting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> – label for the phonon DOS. Must be unique.</li>
<li><strong>phdos</strong> – <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal"><span class="pre">PhononDos</span></code></a> object.</li>
<li><strong>phdos_kwargs</strong> – optional dictionary with the options passed to <cite>get_phdos</cite> to compute the phonon DOS.
Used when phdos is not already an instance of <cite>cls</cite> or when we have to compute the DOS from obj.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.combiplot">
<code class="descname">combiplot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>units='eV'</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.combiplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.combiplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot DOSes on the same figure. Use <code class="docutils literal"><span class="pre">gridplot</span></code> to plot DOSes on different figures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</li>
<li><strong>ylims</strong> – y-axis limits.</li>
<li><strong>fontsize</strong> – Legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for combiplot.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.gridplot">
<code class="descname">gridplot</code><span class="sig-paren">(</span><em>units='eV'</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.gridplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.gridplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot multiple DOSes on a grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>units</strong> – eV for energies in ev/unit_cell, Jmol for results in J/mole.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.plot_harmonic_thermo">
<code class="descname">plot_harmonic_thermo</code><span class="sig-paren">(</span><em>tstart=5</em>, <em>tstop=300</em>, <em>num=50</em>, <em>units='eV'</em>, <em>formula_units=1</em>, <em>quantities='all'</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.plot_harmonic_thermo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.plot_harmonic_thermo" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot thermodinamic properties from the phonon DOS within the harmonic approximation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</li>
<li><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</li>
<li><strong>num</strong> – int, optional Number of samples to generate. Default is 50.</li>
<li><strong>units</strong> – eV for energies in ev/unit_cell, Jmol for results in J/mole.</li>
<li><strong>formula_units</strong> – the number of formula units per unit cell. If unspecified, the
thermodynamic quantities will be given on a per-unit-cell basis.</li>
<li><strong>quantities</strong> – List of strings specifying the thermodinamic quantities to plot.
Possible values in [“internal_energy”, “free_energy”, “entropy”, “c_v”].</li>
<li><strong>fontsize</strong> – Legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.ipw_select_plot">
<code class="descname">ipw_select_plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.ipw_select_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.ipw_select_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to select the plot.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.ipw_harmonic_thermo">
<code class="descname">ipw_harmonic_thermo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.ipw_harmonic_thermo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.ipw_harmonic_thermo" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to plot thermodinamic properties
from the phonon DOS within the harmonic approximation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an jupyter notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.tensors">
<span id="tensors-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">tensors</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.tensors" title="Permalink to this headline">¶</a></h2>
<p>This modules provides tensors objects extracted from dfpt calculations.</p>
<dl class="class">
<dt id="abipy.dfpt.tensors.NLOpticalSusceptibilityTensor">
<em class="property">class </em><code class="descclassname">abipy.dfpt.tensors.</code><code class="descname">NLOpticalSusceptibilityTensor</code><a class="reference internal" href="../_modules/abipy/dfpt/tensors.html#NLOpticalSusceptibilityTensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.tensors.NLOpticalSusceptibilityTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://pymatgen.org/pymatgen.analysis.elasticity.tensors.html#pymatgen.analysis.elasticity.tensors.Tensor" title="(in pymatgen v2017.12.16)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.analysis.elasticity.tensors.Tensor</span></code></a></p>
<p>Subclass of <a class="reference external" href="http://pymatgen.org/pymatgen.analysis.elasticity.tensors.html#pymatgen.analysis.elasticity.tensors.Tensor" title="(in pymatgen v2017.12.16)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.analysis.elasticity.tensors.Tensor</span></code></a> containing the
non-linear optical susceptibility tensor.</p>
<dl class="classmethod">
<dt id="abipy.dfpt.tensors.NLOpticalSusceptibilityTensor.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/tensors.html#NLOpticalSusceptibilityTensor.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.tensors.NLOpticalSusceptibilityTensor.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the tensor from a anaddb.nc netcdf file containing <code class="docutils literal"><span class="pre">dchide</span></code>.
This requires to run anaddb with <code class="docutils literal"><span class="pre">tnlflag</span></code> &gt; 0</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.dfpt.tensors.DielectricTensor">
<em class="property">class </em><code class="descclassname">abipy.dfpt.tensors.</code><code class="descname">DielectricTensor</code><a class="reference internal" href="../_modules/abipy/dfpt/tensors.html#DielectricTensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.tensors.DielectricTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://pymatgen.org/pymatgen.analysis.elasticity.tensors.html#pymatgen.analysis.elasticity.tensors.SquareTensor" title="(in pymatgen v2017.12.16)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.analysis.elasticity.tensors.SquareTensor</span></code></a></p>
<p>Subclass of <a class="reference external" href="http://pymatgen.org/pymatgen.analysis.elasticity.tensors.html#pymatgen.analysis.elasticity.tensors.SquareTensor" title="(in pymatgen v2017.12.16)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.analysis.elasticity.tensors.SquareTensor</span></code></a>
describing a dielectric tensor.</p>
<dl class="method">
<dt id="abipy.dfpt.tensors.DielectricTensor.reflectivity">
<code class="descname">reflectivity</code><span class="sig-paren">(</span><em>tol=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/tensors.html#DielectricTensor.reflectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.dfpt.tensors.DielectricTensor.reflectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>If the tensor is diagonal (with off diagonal elements smaller than tol)
returns the three components of the reflectivity.</p>
</dd></dl>

</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017, The AbiPy group.<br/>
      Last updated on Dec 29, 2017.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>