

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>electrons Package &mdash; abipy 0.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="abipy 0.1.0 documentation" href="../index.html"/>
        <link rel="up" title="The AbiPy API" href="index.html"/>
        <link rel="next" title="gw package" href="gw_api.html"/>
        <link rel="prev" title="abio Package" href="abio_api.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> abipy
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../users/index.html">User&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Abipy Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">The AbiPy API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="core_api.html">core Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools_api.html">tools Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools_api.html#module-abipy.tools"><code class="docutils literal"><span class="pre">tools</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="iotools_api.html">iotools Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="abio_api.html">abio Package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">electrons Package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1"><code class="docutils literal"><span class="pre">electrons</span></code> Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.bse"><code class="docutils literal"><span class="pre">bse</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#charges-module"><code class="docutils literal"><span class="pre">charges</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.ebands"><code class="docutils literal"><span class="pre">ebands</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fatbands-module"><code class="docutils literal"><span class="pre">fatbands</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.gsr"><code class="docutils literal"><span class="pre">gsr</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.gw"><code class="docutils literal"><span class="pre">gw</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.denpot"><code class="docutils literal"><span class="pre">denpot</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.psps"><code class="docutils literal"><span class="pre">psps</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.scissors"><code class="docutils literal"><span class="pre">scissors</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.scr"><code class="docutils literal"><span class="pre">scr</span></code> Module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gw_api.html">gw package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamics_api.html">dynamics Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dfpt_api.html">dfpt Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="waves_api.html">waves Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_api.html">data Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../devel/index.html">The AbiPy Developers&#8217; Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">abipy</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">The AbiPy API</a> &raquo;</li>
      
    <li>electrons Package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/electrons_api.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="electrons-package">
<h1>electrons Package<a class="headerlink" href="#electrons-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2><code class="xref py py-mod docutils literal"><span class="pre">electrons</span></code> Package<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-abipy.electrons"></span><p>This module provides classes and functions for the analysis of electronic properties.</p>
</div>
<div class="section" id="module-abipy.electrons.bse">
<span id="bse-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">bse</span></code> Module<a class="headerlink" href="#module-abipy.electrons.bse" title="Permalink to this headline">¶</a></h2>
<p>Classes for the analysis of BSE calculations</p>
<dl class="class">
<dt id="abipy.electrons.bse.DielectricTensor">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">DielectricTensor</code><span class="sig-paren">(</span><em>mdf</em>, <em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object stores the frequency-dependent macroscopic dielectric tensor
obtained from the dielectric functions for different q-directions.</p>
<dl class="method">
<dt id="abipy.electrons.bse.DielectricTensor.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor.plot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot all the components of the tensor</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</dd>
</dl>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>red_coords</td>
<td>True to plot the reduced coordinate tensor (Default: True)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns:</dt>
<dd>matplotlib figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricTensor.plot_ax">
<code class="descname">plot_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>what</em>, <em>red_coords</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor.plot_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot data on the axis ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> &#8211; plot axis</li>
<li><strong>what</strong> &#8211; Sequential index of the tensor matrix element.</li>
<li><strong>args</strong> &#8211; Positional arguments passed to ax.plot</li>
<li><strong>kwargs</strong> &#8211; Keyword arguments passed to matplotlib. Accepts also:</li>
</ul>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>cplx_mode:</td>
<td><p class="first">string defining the data to print (case-insensitive).
Possible choices are:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;re&#8221;  for real part</li>
<li>&#8220;im&#8221; for imaginary part only.</li>
<li>&#8220;abs&#8217; for the absolute value</li>
</ul>
</div></blockquote>
<p class="last">Options can be concated with &#8220;-&#8221;.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricTensor.symmetrize">
<code class="descname">symmetrize</code><span class="sig-paren">(</span><em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor.symmetrize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor.symmetrize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricTensor.to_array">
<code class="descname">to_array</code><span class="sig-paren">(</span><em>red_coords=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor.to_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor.to_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricTensor.to_func1d">
<code class="descname">to_func1d</code><span class="sig-paren">(</span><em>red_coords=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor.to_func1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor.to_func1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.bse.DielectricFunction">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">DielectricFunction</code><span class="sig-paren">(</span><em>structure</em>, <em>qpoints</em>, <em>wmesh</em>, <em>emacros_q</em>, <em>info</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object stores the frequency-dependent macroscopic dielectric function
computed for different q-directions in reciprocal space.</p>
<dl class="attribute">
<dt id="abipy.electrons.bse.DielectricFunction.calc_type">
<code class="descname">calc_type</code><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.calc_type" title="Permalink to this definition">¶</a></dt>
<dd><p>String with the type of calculation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.DielectricFunction.has_lfe">
<code class="descname">has_lfe</code><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.has_lfe" title="Permalink to this definition">¶</a></dt>
<dd><p>True if MDF includes local field effects.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.DielectricFunction.num_qpoints">
<code class="descname">num_qpoints</code><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.num_qpoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricFunction.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.plot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the MDF.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</dd>
</dl>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>only_mean</td>
<td>True if only the averaged spectrum is wanted (default True)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns:</dt>
<dd>matplotlib figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricFunction.plot_ax">
<code class="descname">plot_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>qpoint=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction.plot_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot data on the axis ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> &#8211; plot axis.</li>
<li><strong>qpoint</strong> &#8211; index of the q-point or Kpoint object or None) to plot emacro_avg.</li>
<li><strong>kwargs</strong> &#8211; <p>Keyword arguments passed to matplotlib. Accepts also:</p>
<dl class="docutils">
<dt>cplx_mode:</dt>
<dd>string defining the data to print (case-insensitive).
Possible choices are<blockquote>
<div><ul>
<li>&#8220;re&#8221;  for real part</li>
<li>&#8220;im&#8221; for imaginary part only.</li>
<li>&#8220;abs&#8217; for the absolute value</li>
</ul>
</div></blockquote>
<p class="last">Options can be concated with &#8220;-&#8221;.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.DielectricFunction.qfrac_coords">
<code class="descname">qfrac_coords</code><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.qfrac_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>The fractional coordinates of the q-points as a ndarray.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricFunction.show_info">
<code class="descname">show_info</code><span class="sig-paren">(</span><em>stream=&lt;open file '&lt;stdout&gt;'</em>, <em>mode 'w'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction.show_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.show_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretty print of the info.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.bse.MdfFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">MdfFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">MdfFile</span><span class="p">(</span><span class="s2">&quot;foo_MDF.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mdf</span><span class="p">:</span>
    <span class="n">mdf</span><span class="o">.</span><span class="n">plot_mdfs</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.exc_mdf">
<code class="descname">exc_mdf</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.exc_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.exc_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Excitonic macroscopic dieletric function.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.bse.MdfFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.get_mdf">
<code class="descname">get_mdf</code><span class="sig-paren">(</span><em>mdf_type=u'exc'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.get_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.get_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8220;Returns the macroscopic dielectric function.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.get_tensor">
<code class="descname">get_tensor</code><span class="sig-paren">(</span><em>mdf_type=u'exc'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.get_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.get_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the macroscopic dielectric tensor from the MDF.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.gwnlf_mdf">
<code class="descname">gwnlf_mdf</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.gwnlf_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.gwnlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>RPA-GW dielectric function without local-field effects.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the parameters that are usually tested for convergence.
Used to build Pandas dataframes in Robots.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.plot_mdfs">
<code class="descname">plot_mdfs</code><span class="sig-paren">(</span><em>cplx_mode=u'Im'</em>, <em>mdf_type=u'all'</em>, <em>qpoint=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.plot_mdfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.plot_mdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the macroscopic dielectric function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cplx_mode</strong> &#8211; <p>string defining the data to print (case-insensitive).
Possible choices are</p>
<blockquote>
<div><ul>
<li>&#8220;re&#8221;  for real part</li>
<li>&#8220;im&#8221; for imaginary part only.</li>
<li>&#8220;abs&#8217; for the absolute value</li>
</ul>
</div></blockquote>
<p>Options can be concated with &#8220;-&#8221;.</p>
</li>
<li><strong>mdf_type</strong> &#8211; <p>Select the type of macroscopic dielectric function.
Possible choices are</p>
<blockquote>
<div><ul>
<li>&#8220;exc&#8221; for the excitonic MDF.</li>
<li>&#8220;rpa&#8221; for RPA MDF.</li>
<li>&#8220;gwrpa&#8221; for GW-RPA MDF</li>
<li>&#8220;all&#8221; if all types are wanted.</li>
</ul>
</div></blockquote>
<p>Options can be concated with &#8220;-&#8221;.</p>
</li>
<li><strong>qpoint</strong> &#8211; index of the q-point or Kpoint object or None to plot emacro_avg.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.qfrac_coords">
<code class="descname">qfrac_coords</code><a class="headerlink" href="#abipy.electrons.bse.MdfFile.qfrac_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>The fractional coordinates of the q-points as a ndarray.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.qpoints">
<code class="descname">qpoints</code><a class="headerlink" href="#abipy.electrons.bse.MdfFile.qpoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.rpanlf_mdf">
<code class="descname">rpanlf_mdf</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.rpanlf_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.rpanlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>RPA dielectric function without local-field effects.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.structure">
<code class="descname">structure</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <cite>Structure</cite> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an ipython notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.bse.MdfReader">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">MdfReader</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads data from the MDF.nc file produced by ABINIT.</p>
<dl class="attribute">
<dt id="abipy.electrons.bse.MdfReader.qpoints">
<code class="descname">qpoints</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.qpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>List of q-points (ndarray).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfReader.read_exc_mdf">
<code class="descname">read_exc_mdf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_exc_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_exc_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the excitonic MDF.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfReader.read_gwnlf_mdf">
<code class="descname">read_gwnlf_mdf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_gwnlf_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_gwnlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the GW-RPA MDF without LF effects.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfReader.read_params">
<code class="descname">read_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the parameters of the run.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfReader.read_rpanlf_mdf">
<code class="descname">read_rpanlf_mdf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_rpanlf_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_rpanlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the KS-RPA MDF without LF effects.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfReader.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.bse.MdfReader.structure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfReader.wmesh">
<code class="descname">wmesh</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.wmesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.wmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>The frequency mesh in eV.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.bse.MdfPlotter">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">MdfPlotter</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Class for plotting multiple MDFs.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">MdfPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mdf_from_file</span><span class="p">(</span><span class="s2">&quot;foo_MDF.nc&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;foo mdf&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mdf_from_file</span><span class="p">(</span><span class="s2">&quot;bar_MDF.nc&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bar mdf&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.bse.MdfPlotter.add_mdf">
<code class="descname">add_mdf</code><span class="sig-paren">(</span><em>label</em>, <em>mdf</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfPlotter.add_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfPlotter.add_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a <a class="reference internal" href="#abipy.electrons.bse.DielectricFunction" title="abipy.electrons.bse.DielectricFunction"><code class="xref py py-class docutils literal"><span class="pre">DielectricFunction</span></code></a> for plotting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> &#8211; name for the MDF. Must be unique.</li>
<li><strong>mdf</strong> &#8211; <a class="reference internal" href="#abipy.electrons.bse.DielectricFunction" title="abipy.electrons.bse.DielectricFunction"><code class="xref py py-class docutils literal"><span class="pre">DielectricFunction</span></code></a> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfPlotter.add_mdf_from_file">
<code class="descname">add_mdf_from_file</code><span class="sig-paren">(</span><em>filepath</em>, <em>mdf_type=u'exc'</em>, <em>label=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfPlotter.add_mdf_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfPlotter.add_mdf_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a mdf for plotting. Reads data from file filepaths.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mdf_type</strong> &#8211; String defining the type of mdf.</li>
<li><strong>name</strong> &#8211; Optional string used to name the plot.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfPlotter.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfPlotter.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Get a matplotlib plot showing the MDFs.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
cplx_mode: string defining the data to print (case-insensitive).</p>
<blockquote>
<div>Possible choices are <cite>re</cite> for the real part, <cite>im</cite> for imaginary part only. <cite>abs</cite> for the absolute value.
Options can be concated with &#8220;-&#8221;.</div></blockquote>
<p class="last">qpoint: index of the q-point or <code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object or None to plot emacro_avg.</p>
</dd>
</dl>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>xlim</td>
<td>x-axis limits. None (Default) for automatic determination.</td>
</tr>
<tr class="row-odd"><td>ylim</td>
<td>y-axis limits. None (Default) for automatic determination.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="charges-module">
<h2><code class="xref py py-mod docutils literal"><span class="pre">charges</span></code> Module<a class="headerlink" href="#charges-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-abipy.electrons.charges"></span><p>HirshfeldCharges&#8221;.</p>
<dl class="class">
<dt id="abipy.electrons.charges.HirshfeldCharges">
<em class="property">class </em><code class="descclassname">abipy.electrons.charges.</code><code class="descname">HirshfeldCharges</code><span class="sig-paren">(</span><em>charges</em>, <em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/charges.html#HirshfeldCharges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.charges.HirshfeldCharges" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<dl class="classmethod">
<dt id="abipy.electrons.charges.HirshfeldCharges.from_cut3d_outfile">
<em class="property">classmethod </em><code class="descname">from_cut3d_outfile</code><span class="sig-paren">(</span><em>filepath</em>, <em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/charges.html#HirshfeldCharges.from_cut3d_outfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.charges.HirshfeldCharges.from_cut3d_outfile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.charges.HirshfeldCharges.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.charges.HirshfeldCharges.structure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.ebands">
<span id="ebands-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">ebands</span></code> Module<a class="headerlink" href="#module-abipy.electrons.ebands" title="Permalink to this headline">¶</a></h2>
<p>Classes for the analysis of electronic structures.</p>
<dl class="class">
<dt id="abipy.electrons.ebands.ElectronBands">
<em class="property">class </em><code class="descclassname">abipy.electrons.ebands.</code><code class="descname">ElectronBands</code><span class="sig-paren">(</span><em>structure</em>, <em>kpoints</em>, <em>eigens</em>, <em>fermie</em>, <em>occfacts</em>, <em>nelect</em>, <em>nspinor</em>, <em>nspden</em>, <em>nband_sk=None</em>, <em>smearing=None</em>, <em>markers=None</em>, <em>widths=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object stores the electronic band structure.</p>
<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.fermie">
<code class="descname">fermie</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.fermie" title="Permalink to this definition">¶</a></dt>
<dd><p>Fermi level in eV. Note that, if the band structure has been computed
with a NSCF run, fermie corresponds to the fermi level obtained
in the SCF run that produced the density used for the band structure calculation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.Error">
<code class="descname">Error</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ElectronBandsError</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.apply_scissors">
<code class="descname">apply_scissors</code><span class="sig-paren">(</span><em>scissors</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.apply_scissors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.apply_scissors" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify the band structure with the scissors operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>scissors</strong> &#8211; An instance of <code class="xref py py-class docutils literal"><span class="pre">Scissors</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code></a> with modified energies.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary with JSON serialization.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.ebands.ElectronBands.as_ebands">
<em class="property">classmethod </em><code class="descname">as_ebands</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.as_ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.as_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code></a> from a generic obj.
Supports:</p>
<blockquote>
<div><ul class="simple">
<li>instances of cls</li>
<li>files (string) that can be open with abiopen and that provide an <cite>ebands</cite> attribute.</li>
<li>objects providing an <cite>ebands</cite> attribute</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.bandwidths">
<code class="descname">bandwidths</code><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.bandwidths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.bandwidths" title="Permalink to this definition">¶</a></dt>
<dd><p>The bandwidth for each spin channel i.e. the energy difference (homo - lomo).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.boxplot">
<code class="descname">boxplot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.boxplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.boxplot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Use seaborn to draw a box plot to show distributions of eigenvalues with respect to the band index.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
e0: Option used to define the zero of energy in the band structure plot. Possible values:</p>
<blockquote>
<div><ul class="simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</div></blockquote>
<p class="last">brange: Only bands such as <cite>brange[0] &lt;= band_index &lt; brange[1]</cite> are included in the plot.
swarm: True to show the datapoints on top of the boxes
kwargs: Keywork arguments passed to seaborn boxplot.</p>
</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Shallow copy of self.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.decorate_ax">
<code class="descname">decorate_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.decorate_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.decorate_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Decoracte matplotlib Axis</p>
<dl class="docutils">
<dt>Accept:</dt>
<dd>title:
klabels
klabel_size:</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.deepcopy">
<code class="descname">deepcopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.deepcopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.deepcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep copy of self.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.degeneracies">
<code class="descname">degeneracies</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>bands_range</em>, <em>tol_ediff=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.degeneracies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.degeneracies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list with the indices of the degenerate bands.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spin</strong> &#8211; Spin index.</li>
<li><strong>kpoint</strong> &#8211; K-point index or <code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object</li>
<li><strong>bands_range</strong> &#8211; List of band indices to analyze.</li>
<li><strong>tol_ediff</strong> &#8211; Tolerance on the energy difference (in eV)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List of tuples [(e0, bands_e0), (e1, bands_e1, ....]
Each tuple stores the degenerate energy and a list with the band indices.
The band structure of silicon at Gamma, for example, will produce something like:
[(-6.3, [0]), (5.6, [1, 2, 3]), (8.1, [4, 5, 6])]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.del_marker">
<code class="descname">del_marker</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.del_marker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.del_marker" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete the entry in self.markers with the specied key. All markers are removed if key is None.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.del_width">
<code class="descname">del_width</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.del_width"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.del_width" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete the entry in self.widths with the specified key. All keys are removed if key is None.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.derivatives">
<code class="descname">derivatives</code><span class="sig-paren">(</span><em>spin</em>, <em>band</em>, <em>order=1</em>, <em>acc=4</em>, <em>asmarker=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.derivatives"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivative of the eigenvalues wrt to k.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> &#8211; Spin index</li>
<li><strong>band</strong> &#8211; Band index</li>
<li><strong>order</strong> &#8211; </li>
<li><strong>acc</strong> &#8211; </li>
<li><strong>asmarker</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns:</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.direct_gaps">
<code class="descname">direct_gaps</code><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.direct_gaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.direct_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <code class="xref py py-class docutils literal"><span class="pre">ElectronTransition</span></code> with info on the direct gaps for each spin.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.dispersionless_states">
<code class="descname">dispersionless_states</code><span class="sig-paren">(</span><em>erange=None</em>, <em>deltae=0.05</em>, <em>kfact=0.9</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.dispersionless_states"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.dispersionless_states" title="Permalink to this definition">¶</a></dt>
<dd><p>This function detects dispersionless states.
A state is dispersionless if there are more that (nkpt * kfact) energies
in the energy intervale [e0-deltae, e0+deltae]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>range to be analyzed in the form [emin, emax]</strong> (<em>erange=Energy</em>) &#8211; </li>
<li><strong>deltae</strong> &#8211; Defines the energy interval in eV around the KS eigenvalue.</li>
<li><strong>kfact</strong> &#8211; Can be used to change the criterion used to detect dispersionless states.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List of <code class="xref py py-class docutils literal"><span class="pre">Electron</span></code> objects. Each item contains information on
the energy, the occupation and the location of the dispersionless band.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.effective_masses">
<code class="descname">effective_masses</code><span class="sig-paren">(</span><em>spin</em>, <em>band</em>, <em>acc=4</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.effective_masses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.effective_masses" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the effective masses for the given <cite>spin</cite> and <cite>band</cite> index.
Use finite difference with accuracy <cite>acc</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">numpy array of size nkpt.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.effmass_line">
<code class="descname">effmass_line</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band</em>, <em>acc=4</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.effmass_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.effmass_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the effective masses along a line. Requires band energies on a k-path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> &#8211; Spin index.</li>
<li><strong>kpoint</strong> &#8211; integer or class:<cite>Kpoint</cite> object. Note that if kpoint is not an integer,
and the path contains duplicated k-points, the first k-point is selected.</li>
<li><strong>band</strong> &#8211; Band index.</li>
<li><strong>acc</strong> &#8211; accuracy</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns:</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.eigens">
<code class="descname">eigens</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.eigens" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigenvalues in eV. ndarray with shape (nspin, nkpt, mband).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.enemax">
<code class="descname">enemax</code><span class="sig-paren">(</span><em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.enemax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.enemax" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the maximum of the eigenvalues.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.enemin">
<code class="descname">enemin</code><span class="sig-paren">(</span><em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.enemin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.enemin" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the minimum of the eigenvalues.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.ebands.ElectronBands.from_dict">
<em class="property">classmethod </em><code class="descname">from_dict</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.ebands.ElectronBands.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code></a> from a netCDF file.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.fundamental_gaps">
<code class="descname">fundamental_gaps</code><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.fundamental_gaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.fundamental_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <code class="xref py py-class docutils literal"><span class="pre">ElectronTransition</span></code> with info on the fundamental gaps for each spin.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_dict4frame">
<code class="descname">get_dict4frame</code><span class="sig-paren">(</span><em>with_spglib=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_dict4frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_dict4frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with the most important parameters:</p>
<blockquote>
<div><ul class="simple">
<li>Chemical formula and number of atoms.</li>
<li>Lattice lengths, angles and volume.</li>
<li>The spacegroup number computed by Abinit (set to None if not available).</li>
<li>The spacegroup number and symbol computed by spglib (set to None not <cite>with_spglib</cite>).</li>
</ul>
</div></blockquote>
<p>Useful to construct pandas DataFrames</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>with_spglib</strong> &#8211; If True, spglib is invoked to get the spacegroup symbol and number</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_e0">
<code class="descname">get_e0</code><span class="sig-paren">(</span><em>e0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_e0" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_edos">
<code class="descname">get_edos</code><span class="sig-paren">(</span><em>method=u'gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the electronic DOS on a linear mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> &#8211; String defining the method for the computation of the DOS.</li>
<li><strong>step</strong> &#8211; Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> &#8211; Standard deviation (eV) of the gaussian.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">ElectronDos</span></code></a> object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_ejdos">
<code class="descname">get_ejdos</code><span class="sig-paren">(</span><em>spin</em>, <em>valence</em>, <em>conduction</em>, <em>method=u'gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>mesh=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_ejdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_ejdos" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Compute the join density of states at q == 0.</dt>
<dd><img src="../_images/mathmpl/math-409d93a935.png" style="position: relative; bottom: -21px"/></dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spin</strong> &#8211; Spin index.</li>
<li><strong>valence</strong> &#8211; Int or iterable with the valence indices.</li>
<li><strong>conduction</strong> &#8211; Int or iterable with the conduction indices.</li>
<li><strong>method</strong> &#8211; String defining the method.</li>
<li><strong>step</strong> &#8211; Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> &#8211; Standard deviation (eV) of the gaussian.</li>
<li><strong>mesh</strong> &#8211; Frequency mesh to use. If None, the mesh is computed automatically from the eigenvalues.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal"><span class="pre">Function1D</span></code> object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.has_bzmesh">
<code class="descname">has_bzmesh</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_bzmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the k-point sampling is homogeneous.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.has_bzpath">
<code class="descname">has_bzpath</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_bzpath" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the bands are computed on a k-path.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.has_metallic_scheme">
<code class="descname">has_metallic_scheme</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_metallic_scheme" title="Permalink to this definition">¶</a></dt>
<dd><p>True if we are using a metallic scheme for occupancies.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.has_timrev">
<code class="descname">has_timrev</code><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.has_timrev"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_timrev" title="Permalink to this definition">¶</a></dt>
<dd><p>True if time-reversal symmetry is used in the BZ sampling.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.homo_sk">
<code class="descname">homo_sk</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.homo_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.homo_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the HOMO state for the given spin, kpoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> &#8211; Spin index</li>
<li><strong>kpoint</strong> &#8211; Index of the kpoint or <code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.homos">
<code class="descname">homos</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.homos" title="Permalink to this definition">¶</a></dt>
<dd><p>homo states for each spin channel as a list of nsppol <code class="xref py py-class docutils literal"><span class="pre">Electron</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.interpolate">
<code class="descname">interpolate</code><span class="sig-paren">(</span><em>lpratio=5</em>, <em>vertices_names=None</em>, <em>line_density=20</em>, <em>kmesh=None</em>, <em>is_shift=None</em>, <em>filter_params=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate energies in k-space along a k-path and, optionally, in the IBZ for DOS calculations.
Note that the interpolation will likely fail if there are symmetrical k-points in the input sampling
so it&#8217;s recommended to call this method with band structure obtained in the IBZ.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lpratio</strong> &#8211; Ratio between the number of star functions and the number of ab-initio k-points.
The default should be OK in many systems, larger values may be required for accurate derivatives.</li>
<li><strong>vertices_names</strong> &#8211; Used to specify the k-path for the interpolated band structure
It&#8217;s a list of tuple, each tuple is of the form (kfrac_coords, kname) where
kfrac_coords are the reduced coordinates of the k-point and kname is a string with the name of
the k-point. Each point represents a vertex of the k-path. <cite>line_density</cite> defines
the density of the sampling. If None, the k-path is automatically generated according
to the point group of the system.</li>
<li><strong>line_density</strong> &#8211; Number of points in the smallest segment of the k-path. Used with <cite>vertices_names</cite>.</li>
<li><strong>kmesh</strong> &#8211; Used to activate the interpolation on the homogeneous mesh for DOS (uses spglib API).
kmesh is given by three integers and specifies mesh numbers along reciprocal primitive axis.</li>
<li><strong>is_shift</strong> &#8211; three integers (spglib API). When is_shift is not None, the kmesh is shifted along
the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</li>
<li><strong>filter_params</strong> &#8211; TO BE described.</li>
<li><strong>verbose</strong> &#8211; Verbosity level</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><p>namedtuple with the following attributes</p>
<p>ebands_kpath: <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code></a> with the interpolated band structure on the k-path.
ebands_kmesh: <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code></a> with the interpolated band structure on the k-mesh.</p>
<blockquote>
<div><p>None if kmesh is not given.</p>
</div></blockquote>
<p>interpolator: <code class="xref py py-class docutils literal"><span class="pre">SkwInterpolator</span></code> object.</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.ipw_dos">
<code class="descname">ipw_dos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.ipw_dos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.ipw_dos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to compute the electron DOS.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.kidxs">
<code class="descname">kidxs</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.kidxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Range with the index of the k-points.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.kindex">
<code class="descname">kindex</code><span class="sig-paren">(</span><em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.kindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.kindex" title="Permalink to this definition">¶</a></dt>
<dd><p>The index of the k-point in the internal list of k-points.
Accepts: <code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> instance or integer.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.kptopt">
<code class="descname">kptopt</code><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.kptopt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.kptopt" title="Permalink to this definition">¶</a></dt>
<dd><p>The value of the kptopt input variable.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.lomo_sk">
<code class="descname">lomo_sk</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.lomo_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lomo_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the LOMO state for the given spin, kpoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> &#8211; Spin index</li>
<li><strong>kpoint</strong> &#8211; Index of the kpoint or <code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.lomos">
<code class="descname">lomos</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lomos" title="Permalink to this definition">¶</a></dt>
<dd><p>lomo states for each spin channel as a list of nsppol <code class="xref py py-class docutils literal"><span class="pre">Electron</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.lumo_sk">
<code class="descname">lumo_sk</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.lumo_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lumo_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the LUMO state for the given spin, kpoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> &#8211; Spin index</li>
<li><strong>kpoint</strong> &#8211; Index of the kpoint or <code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.lumos">
<code class="descname">lumos</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lumos" title="Permalink to this definition">¶</a></dt>
<dd><p>lumo states for each spin channel as a list of nsppol <code class="xref py py-class docutils literal"><span class="pre">Electron</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.markers">
<code class="descname">markers</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.markers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.nband">
<code class="descname">nband</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.nband" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.occfacts">
<code class="descname">occfacts</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.occfacts" title="Permalink to this definition">¶</a></dt>
<dd><p>Occupation factors. ndarray with shape (nspin, nkpt, mband).</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.pad_fermie">
<code class="descname">pad_fermie</code><em class="property"> = 1e-06</em><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.pad_fermie" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the band structure.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
klabels: dictionary whose keys are tuple with the reduced</p>
<blockquote>
<div>coordinates of the k-points. The values are the labels. e.g.
klabels = {(0.0,0.0,0.0): &#8220;$Gamma$&#8221;, (0.5,0,0):&#8221;L&#8221;}.</div></blockquote>
<p>band_range: Tuple specifying the minimum and maximum band to plot (default: all bands are plotted)
ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<dl class="last docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
<dt>marker: String defining the marker to plot. Accepts the syntax <cite>markername:fact</cite> where</dt>
<dd>fact is a float used to scale the marker size.</dd>
<dt>width: String defining the width to plot. Accepts the syntax widthname:fact where</dt>
<dd>fact is a float used to scale the stripe size.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_ax">
<code class="descname">plot_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>e0</em>, <em>spin=None</em>, <em>band=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot the energies for (spin, band) on the axis ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> &#8211; Matplotlib axis.</li>
<li><strong>e0</strong> &#8211; Option used to define the zero of energy in the band structure plot.</li>
<li><strong>spin</strong> &#8211; Spin index. If None, all spins are plotted.</li>
<li><strong>band</strong> &#8211; Band index, If None, all bands are plotted.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return matplotlib lines</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_ejdosvc">
<code class="descname">plot_ejdosvc</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_ejdosvc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_ejdosvc" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the decomposition of the joint-density of States (JDOS).</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>vrange: Int or <cite>Iterable</cite> with the indices of the valence bands to consider.
crange: Int or <cite>Iterable</cite> with the indices of the conduction bands to consider.
method: String defining the method.
step: Energy step (eV) of the linear mesh.
width: Standard deviation (eV) of the gaussian.
cumulative: True for cumulative plots (default).
ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_marker_ax">
<code class="descname">plot_marker_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>key</em>, <em>e0</em>, <em>fact=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_marker_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_marker_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot the markers on the axes ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e0</strong> &#8211; Option used to define the zero of energy in the band structure plot.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_width_ax">
<code class="descname">plot_width_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>key</em>, <em>e0</em>, <em>spin=None</em>, <em>band=None</em>, <em>fact=1.0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_width_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_width_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot fatbands for the given (spin,band) on the axis ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e0</strong> &#8211; Option used to define the zero of energy in the band structure plot.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_with_edos">
<code class="descname">plot_with_edos</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_with_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_with_edos" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the band structure and the DOS.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">dos: An instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">ElectronDos</span></code></a>.
klabels: dictionary whose keys are tuple with the reduced coordinates of the k-points.</p>
<blockquote>
<div>The values are the labels. e.g. <cite>klabels = {(0.0,0.0,0.0): &#8220;$Gamma$&#8221;, (0.5,0,0): &#8220;L&#8221;}</cite>.</div></blockquote>
<dl class="last docutils">
<dt>axlist: The axes for the bandstructure plot and the DOS plot. If axlist is None, a new figure</dt>
<dd>is created and the two axes are automatically generated.</dd>
<dt>ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></dt>
<dd>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</dd>
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt><cite>fermie</cite>: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.</dt>
<dd><p class="first last">Note that, by default, the Fermi energy is taken from the band structure object
i.e. the Fermi energy computed at the end of the SCF file that produced the density.
This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
the one used to compute the density. See <cite>edos_fermie</cite>.</p>
</dd>
</dl>
</li>
<li><p class="first"><cite>edos_fermie</cite>: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.</p>
</li>
<li><p class="first">Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</p>
</li>
<li><p class="first">None: Don&#8217;t shift energies, equivalent to e0=0</p>
</li>
</ul>
</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.raw_print">
<code class="descname">raw_print</code><span class="sig-paren">(</span><em>stream=&lt;open file '&lt;stdout&gt;'</em>, <em>mode 'w'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.raw_print"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.raw_print" title="Permalink to this definition">¶</a></dt>
<dd><p>Print k-points and energies on stream.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.recalc_fermie">
<code class="descname">recalc_fermie</code><span class="sig-paren">(</span><em>nelect=None</em>, <em>method=u'gaussian'</em>, <em>step=0.001</em>, <em>width=0.002</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.recalc_fermie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.recalc_fermie" title="Permalink to this definition">¶</a></dt>
<dd><p>Recompute the Fermi level.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.reciprocal_lattice">
<code class="descname">reciprocal_lattice</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.reciprocal_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Reciprocal lattice vectors in Angstrom.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.sb_iter">
<code class="descname">sb_iter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.sb_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.sb_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over (spin, band) indices.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.set_fermie">
<code class="descname">set_fermie</code><span class="sig-paren">(</span><em>fermie</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.set_fermie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.set_fermie" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.set_marker">
<code class="descname">set_marker</code><span class="sig-paren">(</span><em>key</em>, <em>xys</em>, <em>extend=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.set_marker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.set_marker" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an entry in the markers dictionary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> &#8211; string used to label the set of markers.</li>
<li><strong>xys</strong> &#8211; Three iterables x,y,s where x[i],y[i] gives the
positions of the i-th markers in the plot and s[i] is the size of the marker.</li>
<li><strong>extend</strong> &#8211; True if the values xys should be added to a pre-existing marker.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.set_width">
<code class="descname">set_width</code><span class="sig-paren">(</span><em>key</em>, <em>width</em>, <em>overwrite=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.set_width"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.set_width" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an entry in the widths dictionary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> &#8211; string used to label the set of markers.</li>
<li><strong>width</strong> &#8211; array-like of positive numbers, shape is [nsppol, nkpt, mband].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.shape">
<code class="descname">shape</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape of the array with the eigenvalues.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.show_bz">
<code class="descname">show_bz</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.show_bz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.show_bz" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <cite>matplotlib</cite> to show the Brillouin zone.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.skb_iter">
<code class="descname">skb_iter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.skb_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.skb_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over (spin, k, band) indices.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.spacing">
<code class="descname">spacing</code><span class="sig-paren">(</span><em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.spacing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the statistical parameters of the energy spacing, i.e. e[b+1] - e[b]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><cite>namedtuple</cite> with the statistical parameters in eV</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.spins">
<code class="descname">spins</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.spins" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin range</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.statdiff">
<code class="descname">statdiff</code><span class="sig-paren">(</span><em>other</em>, <em>axis=None</em>, <em>numpy_op=&lt;ufunc 'absolute'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.statdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.statdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the eigenenergies of two bands and compute the
statistical parameters: mean, standard deviation, min and max
The bands are aligned wrt to their fermi level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>other</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">BandStructure</span></code> object.</li>
<li><strong>axis</strong> &#8211; Axis along which the statistical parameters are computed.
The default is to compute the parameters of the flattened array.</li>
<li><strong>numpy_op</strong> &#8211; Numpy function to apply to the difference of the eigenvalues. The
default computes <a href="#id4"><span class="problematic" id="id5">|self.eigens - other.eigens|</span></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><cite>namedtuple</cite> with the statistical parameters in eV</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_bxsf">
<code class="descname">to_bxsf</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_bxsf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_bxsf" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the full band structure to <cite>filepath</cite> in BXSF format
suitable for the visualization of the Fermi surface with Xcrysden (xcrysden &#8211;bxsf FILE).
Require k-points in IBZ and gamma-centered k-mesh.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_json">
<code class="descname">to_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a json string representation of the MSONable object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_pdframe">
<code class="descname">to_pdframe</code><span class="sig-paren">(</span><em>e0=u'fermie'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_pdframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_pdframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pandas DataFrame with the following columns:</p>
<blockquote>
<div>[&#8216;spin&#8217;, &#8216;kidx&#8217;, &#8216;band&#8217;, &#8216;eig&#8217;, &#8216;occ&#8217;, &#8216;kpoint&#8217;]</div></blockquote>
<p>where:</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Column</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>spin</td>
<td>spin index</td>
</tr>
<tr class="row-odd"><td>kidx</td>
<td>k-point index</td>
</tr>
<tr class="row-even"><td>band</td>
<td>band index</td>
</tr>
<tr class="row-odd"><td>eig</td>
<td>KS eigenvalue in eV.</td>
</tr>
<tr class="row-even"><td>occ</td>
<td>Occupation of the state.</td>
</tr>
<tr class="row-odd"><td>kpoint</td>
<td><code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e0</strong> &#8211; Option used to define the zero of energy in the band structure plot. Possible values:
- <cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don&#8217;t shift energies, equivalent to e0=0
The Fermi energy is saved in frame.fermie</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_pymatgen">
<code class="descname">to_pymatgen</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_pymatgen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pymatgen bandstructure object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>title=None</em>, <em>with_structure=True</em>, <em>with_kpoints=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Human-readable string with useful info such as band gaps, position of HOMO, LOMO...</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>with_structure</strong> &#8211; False if structural info shoud not be displayed.</li>
<li><strong>with_kpoints</strong> &#8211; False if k-point info shoud not be displayed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_xmgrace">
<code class="descname">to_xmgrace</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_xmgrace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_xmgrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Write xmgrace file with band structure energies and labels for high-symmetry k-points.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.widths">
<code class="descname">widths</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.widths" title="Permalink to this definition">¶</a></dt>
<dd><p>Widths dictionary</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.ebands.ElectronDos">
<em class="property">class </em><code class="descclassname">abipy.electrons.ebands.</code><code class="descname">ElectronDos</code><span class="sig-paren">(</span><em>mesh</em>, <em>spin_dos</em>, <em>nelect</em>, <em>fermie=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object stores the electronic density of states.
It is usually created by calling the get_edos method of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code></a>.</p>
<dl class="classmethod">
<dt id="abipy.electrons.ebands.ElectronDos.as_edos">
<em class="property">classmethod </em><code class="descname">as_edos</code><span class="sig-paren">(</span><em>obj</em>, <em>edos_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.as_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.as_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">ElectronDos</span></code></a> from a generic obj.
Supports:</p>
<blockquote>
<div><ul class="simple">
<li>instances of cls</li>
<li>files (string) that can be open with abiopen and that provide an <cite>ebands</cite> attribute.</li>
<li>objects providing an <cite>ebands</cite> or <cite>get_edos</cite> attribute</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>edos_kwargs</strong> &#8211; optional dictionary with the options passed to <cite>get_edos</cite> to compute the electron DOS.</li>
<li><strong>when obj is not already an instance of cls.</strong> (<em>Used</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.dos_idos">
<code class="descname">dos_idos</code><span class="sig-paren">(</span><em>spin=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.dos_idos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.dos_idos" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns DOS and IDOS for given spin. Total DOS and IDOS if spin is None.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.find_mu">
<code class="descname">find_mu</code><span class="sig-paren">(</span><em>nelect</em>, <em>spin=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.find_mu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.find_mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the chemical potential given the number of electrons.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.get_e0">
<code class="descname">get_e0</code><span class="sig-paren">(</span><em>e0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.get_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.get_e0" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot DOS</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>spin: Selects the spin component, None if total DOS is wanted.
ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
xlims: Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">kwargs: options passed to ax.plot.</p>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.plot_ax">
<code class="descname">plot_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>e0</em>, <em>spin=None</em>, <em>what=u'd'</em>, <em>fact=1.0</em>, <em>exchange_xy=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot the DOS data on the axis ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax</strong> &#8211; matplotlib axis.</li>
<li><strong>e0</strong> &#8211; Option used to define the zero of energy in the band structure plot.</li>
<li><strong>spin</strong> &#8211; selects the spin component, None for total DOS, IDOS.</li>
<li><strong>what</strong> &#8211; string selecting what will be plotted:
&#8220;d&#8221; for DOS, &#8220;i&#8221; for IDOS. chars can be concatenated
hence what=&#8221;id&#8221; plots both IDOS and DOS. (default &#8220;d&#8221;).</li>
<li><strong>fact</strong> &#8211; Multiplication factor for DOS/IDOS. Usually +-1 for spin DOS</li>
<li><strong>exchange_xy</strong> &#8211; True to exchange x-y axes.</li>
<li><strong>kwargs</strong> &#8211; Options passes to matplotlib.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of lines added to the axis.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.plot_dos_idos">
<code class="descname">plot_dos_idos</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot_dos_idos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot_dos_idos" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot DOS and IDOS.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>spin: Selects the spin component, None if total DOS is wanted.
xlims: Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">kwargs: options passed to plot_ax</p>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.plot_up_minus_down">
<code class="descname">plot_up_minus_down</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot_up_minus_down"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot_up_minus_down" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot DOS</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
xlims: Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">kwargs: options passed to ax.plot.</p>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.electrons.ebands.frame_from_ebands">
<code class="descclassname">abipy.electrons.ebands.</code><code class="descname">frame_from_ebands</code><span class="sig-paren">(</span><em>ebands_objects</em>, <em>index=None</em>, <em>with_spglib=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#frame_from_ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.frame_from_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a pandas dataframe with the most important results available in a list of band structures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>struct_objects</strong> &#8211; List of objects that can be converted to structure.
Support netcdf filenames or <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code></a> objects
See <cite>ElectronBands.as_ebands</cite> for the complete list.</li>
<li><strong>index</strong> &#8211; Index of the dataframe.</li>
<li><strong>with_spglib</strong> &#8211; If True, spglib is invoked to get the spacegroup symbol and number.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pandas <code class="xref py py-class docutils literal"><span class="pre">DataFrame</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter">
<em class="property">class </em><code class="descclassname">abipy.electrons.ebands.</code><code class="descname">ElectronBandsPlotter</code><span class="sig-paren">(</span><em>key_ebands=None</em>, <em>key_edos=None</em>, <em>edos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Class for plotting electronic band structure and DOSes.
Supports plots on the same graph or separated plots.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">ElectronBandsPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_ebands</span><span class="p">(</span><span class="s2">&quot;foo bands&quot;</span><span class="p">,</span> <span class="s2">&quot;foo.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_ebands</span><span class="p">(</span><span class="s2">&quot;bar bands&quot;</span><span class="p">,</span> <span class="s2">&quot;bar.nc&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">gridplot</span><span class="p">()</span>
</pre></div>
</div>
<p>Dictionary with the mapping label &#8211;&gt; edos.</p>
<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.add_ebands">
<code class="descname">add_ebands</code><span class="sig-paren">(</span><em>label</em>, <em>bands</em>, <em>dos=None</em>, <em>edos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.add_ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.add_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a band structure and optionally a dos to the plotter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> &#8211; label for the bands. Must be unique.</li>
<li><strong>bands</strong> &#8211; <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code></a> object.</li>
<li><strong>dos</strong> &#8211; <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">ElectronDos</span></code></a> object.</li>
<li><strong>edos_kwargs</strong> &#8211; optional dictionary with the options passed to <cite>get_edos</cite> to compute the electron DOS.
Used only if <cite>dos</cite> is not None and it not an ElectronDos instance.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.add_ebands_from_file">
<code class="descname">add_ebands_from_file</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.add_ebands_from_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.animate">
<code class="descname">animate</code><span class="sig-paren">(</span><em>e0=u'fermie'</em>, <em>interval=250</em>, <em>savefile=None</em>, <em>show=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.animate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>Use matplotlib to animate a list of band structure plots (with or without DOS).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>e0</strong> &#8211; <p>Option used to define the zero of energy in the band structure plot. Possible values:
- <cite>fermie</cite>: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.</p>
<blockquote>
<div>Note that, by default, the Fermi energy is taken from the band structure object
i.e. the Fermi energy computed at the end of the SCF file that produced the density.
See <cite>edos_fermie</cite>.</div></blockquote>
<ul>
<li><cite>edos_fermie</cite>: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</li>
<li><strong>interval</strong> &#8211; draws a new frame every interval milliseconds.</li>
<li><strong>savefile</strong> &#8211; Use e.g. &#8216;myanimation.mp4&#8217; to save the animation in mp4 format.</li>
<li><strong>show</strong> &#8211; True if the animation should be shown immediately</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Animation object.</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>See also <a class="reference external" href="http://matplotlib.org/api/animation_api.html">http://matplotlib.org/api/animation_api.html</a></dt>
<dd><a class="reference external" href="http://jakevdp.github.io/blog/2012/08/18/matplotlib-animation-tutorial/">http://jakevdp.github.io/blog/2012/08/18/matplotlib-animation-tutorial/</a></dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It would be nice to have the possibility of animating the title of the plot, unfortunately
this feature is not available in the present version of matplotlib. See
<a class="reference external" href="http://stackoverflow.com/questions/17558096/animated-title-in-matplotlib">http://stackoverflow.com/questions/17558096/animated-title-in-matplotlib</a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.bands_statdiff">
<code class="descname">bands_statdiff</code><span class="sig-paren">(</span><em>ref=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.bands_statdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.bands_statdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the reference bands with index ref with the other bands stored in the plotter.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.boxplot">
<code class="descname">boxplot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.boxplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.boxplot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Use seaborn to draw a box plot to show distributions of eigenvalues with respect to the band index.
Band structures are drawn on different subplots.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p class="last">brange: Only bands such as <cite>brange[0] &lt;= band_index &lt; brange[1]</cite> are included in the plot.
swarm: True to show the datapoints on top of the boxes
kwargs: Keywork arguments passed to seaborn boxplot.</p>
</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.combiboxplot">
<code class="descname">combiboxplot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.combiboxplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.combiboxplot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Use seaborn to draw a box plot comparing the distributions of the eigenvalues
Band structures are drawn on the same plot.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p class="last">brange: Only bands such as <cite>brange[0] &lt;= band_index &lt; brange[1]</cite> are included in the plot.
swarm: True to show the datapoints on top of the boxes
ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
kwargs: Keyword arguments passed to seaborn boxplot.</p>
</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.combiplot">
<code class="descname">combiplot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.combiplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.combiplot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the band structure and the DOS on the same figure.
Use <cite>gridplot</cite> to plot band structures on different figures.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (ebands.fermie)</dt>
<dd><p class="first last">Note that, by default, the Fermi energy is taken from the band structure object
i.e. the Fermi energy computed at the end of the SCF file that produced the density.
This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
the one used to compute the density. See <cite>edos_fermie</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>edos_fermie</cite>: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.</dt>
<dd><p class="first last">Available only if plotter contains dos objects.</p>
</dd>
</dl>
</li>
<li><p class="first">Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</p>
</li>
<li><p class="first">None: Don&#8217;t shift energies, equivalent to e0=0</p>
</li>
</ul>
</dd>
<dt>ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></dt>
<dd>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.ebands_list">
<code class="descname">ebands_list</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.ebands_list" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8220;List of <cite>:class:ElectronBands</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.edoses_list">
<code class="descname">edoses_list</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.edoses_list" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8220;List of <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">ElectronDos</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.get_ebands_frame">
<code class="descname">get_ebands_frame</code><span class="sig-paren">(</span><em>with_spglib=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.get_ebands_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.get_ebands_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a pandas dataframe with the most important results available in the band structures.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.gridplot">
<code class="descname">gridplot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.gridplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.gridplot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot multiple electron bandstructures and optionally DOSes on a grid.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>eb_objects: List of objects from which the band structures are extracted.</dt>
<dd>Each item in eb_objects is either a string with the path of the netcdf file,
or one of the abipy object with an <cite>ebands</cite> attribute or a <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code></a> object.</dd>
<dt>edos_objects:</dt>
<dd>List of objects from which the electron DOSes are extracted.
Accept filepaths or <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">ElectronDos</span></code></a> objects. If edos_objects is not None,
each subplot in the grid contains a band structure with DOS else a simple bandstructure plot.</dd>
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt><cite>fermie</cite>: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.</dt>
<dd><p class="first last">Note that, by default, the Fermi energy is taken from the band structure object
i.e. the Fermi energy computed at the end of the SCF file that produced the density.
This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
the one used to compute the density. See <cite>edos_fermie</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>edos_fermie</cite>: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.</dt>
<dd><p class="first last">Available only if edos_objects is not None</p>
</dd>
</dl>
</li>
<li><p class="first">Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</p>
</li>
<li><p class="first">None: Don&#8217;t shift energies, equivalent to e0=0</p>
</li>
</ul>
</dd>
<dt>ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></dt>
<dd>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.iter_lineopt">
<code class="descname">iter_lineopt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.iter_lineopt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.iter_lineopt" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates style options for lines.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an ipython notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.ebands.ElectronDosPlotter">
<em class="property">class </em><code class="descclassname">abipy.electrons.ebands.</code><code class="descname">ElectronDosPlotter</code><span class="sig-paren">(</span><em>key_edos=None</em>, <em>edos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Class for plotting electronic DOSes.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">ElectronDosPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_edos</span><span class="p">(</span><span class="s2">&quot;foo dos&quot;</span><span class="p">,</span> <span class="s2">&quot;foo.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_edos</span><span class="p">(</span><span class="s2">&quot;bar dos&quot;</span><span class="p">,</span> <span class="s2">&quot;bar.nc&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">gridplot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.add_edos">
<code class="descname">add_edos</code><span class="sig-paren">(</span><em>label</em>, <em>edos</em>, <em>edos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.add_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.add_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a DOS for plotting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> &#8211; label for the DOS. Must be unique.</li>
<li><strong>dos</strong> &#8211; <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">ElectronDos</span></code></a> object.</li>
<li><strong>edos_kwargs</strong> &#8211; optional dictionary with the options passed to <cite>get_edos</cite> to compute the electron DOS.
Used only if <cite>edos</cite> is not an ElectronDos instance.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.add_edos_from_file">
<code class="descname">add_edos_from_file</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.add_edos_from_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.combiplot">
<code class="descname">combiplot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.combiplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.combiplot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the the DOSes on the same figure.
Use <cite>gridplot</cite> to plot DOSes on different figures.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
e0: Option used to define the zero of energy in the band structure plot. Possible values:</p>
<blockquote>
<div><ul class="simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</div></blockquote>
<dl class="last docutils">
<dt>xlims: Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite></dt>
<dd>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.edos_list">
<code class="descname">edos_list</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.edos_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List of DOSes</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.gridplot">
<code class="descname">gridplot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.gridplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.gridplot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot multiple DOSes on a grid.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt><cite>fermie</cite>: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.</dt>
<dd><p class="first last">Note that, by default, the Fermi energy is taken from the band structure object
i.e. the Fermi energy computed at the end of the SCF file that produced the density.
This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
the one used to compute the density. See <cite>edos_fermie</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>edos_fermie</cite>: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.</dt>
<dd><p class="first last">Available only if edos_objects is not None</p>
</dd>
</dl>
</li>
<li><p class="first">Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</p>
</li>
<li><p class="first">None: Don&#8217;t shift energies, equivalent to e0=0</p>
</li>
</ul>
</dd>
<dt>xlims: Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite></dt>
<dd>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an ipython notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="fatbands-module">
<h2><code class="xref py py-mod docutils literal"><span class="pre">fatbands</span></code> Module<a class="headerlink" href="#fatbands-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-abipy.electrons.fatbands"></span><p>Classes for the analysis of electronic fatbands and projected DOSes.</p>
<dl class="class">
<dt id="abipy.electrons.fatbands.FatBandsFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.fatbands.</code><code class="descname">FatBandsFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Provides methods to analyze the data stored in the FATBANDS.nc file.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">abiopen</span><span class="p">(</span><span class="s2">&quot;out_FATBANDS.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fb</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">fb</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
    <span class="n">fb</span><span class="o">.</span><span class="n">plot_fatbands_lview</span><span class="p">()</span>
</pre></div>
</div>
<p>Alternatively, one can use the abiopen.py script to open the file in an ipython notebook with</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ abiopen.py out_FATBANDS.nc -nb
</pre></div>
</div>
<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.alpha">
<code class="descname">alpha</code><em class="property"> = 0.6</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.alpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of the <cite>with</cite> context manager.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.eb_plotax_kwargs">
<code class="descname">eb_plotax_kwargs</code><span class="sig-paren">(</span><em>spin</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.eb_plotax_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.eb_plotax_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the options passed to ebands.plot_ax
when plotting a band line with spin index <cite>spin</cite>.
Subclasses can redefine the implementation to customize the plots.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.ebands">
<code class="descname">ebands</code><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code> object.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.fatbands.FatBandsFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_dos_integrator">
<code class="descname">get_dos_integrator</code><span class="sig-paren">(</span><em>method</em>, <em>step</em>, <em>width</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_dos_integrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_dos_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>FatBandsFile can use differerent integrators that are cached in self._cached_dos_integrators</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_spilling">
<code class="descname">get_spilling</code><span class="sig-paren">(</span><em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_spilling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_spilling" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the spilling parameter
If <cite>spin</cite> and <cite>band</cite> are not specified, the method returns the spilling for all states
as a [nsppol, mband, nkpt] numpy array else the spilling for (spin, band) with shape [nkpt].</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_w_symbol">
<code class="descname">get_w_symbol</code><span class="sig-paren">(</span><em>symbol</em>, <em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_w_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_w_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the DOS weights for a given type specified in terms of the
chemical symbol <cite>symbol</cite>. The weights are summed over m and lmax[symbol] and
over all atoms of the same type.
If <cite>spin</cite> and <cite>band</cite> are not specified, the method returns the weights
for all spins and bands else the contribution for (spin, band).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_wl_atom">
<code class="descname">get_wl_atom</code><span class="sig-paren">(</span><em>iatom</em>, <em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_wl_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_wl_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the l-dependent DOS weights for atom index <cite>iatom</cite>. The weights are summed over m.
If <cite>spin</cite> and <cite>band</cite> are not specified, the method returns the weights
for all spin and bands else the contribution for (spin, band)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_wl_symbol">
<code class="descname">get_wl_symbol</code><span class="sig-paren">(</span><em>symbol</em>, <em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_wl_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_wl_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the l-dependent DOS weights for a given type specified in terms of the
chemical symbol <cite>symbol</cite>. The weights are summed over m and over all atoms of the same type.
If <cite>spin</cite> and <cite>band</cite> are not specified, the method returns the weights
for all spins and bands else the contribution for (spin, band).</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.l2color">
<code class="descname">l2color</code><em class="property"> = {0: u'red', 1: u'blue', 2: u'green', 3: u'yellow', 4: u'orange'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.l2color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.l2tex">
<code class="descname">l2tex</code><em class="property"> = {0: u'$l=s$', 1: u'$l=p$', 2: u'$l=d$', 3: u'$l=f$', 4: u'$l=g$'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.l2tex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.linecolor">
<code class="descname">linecolor</code><em class="property"> = u'grey'</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.linecolor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.linewidth">
<code class="descname">linewidth</code><em class="property"> = 0.1</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.linewidth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.marker_size">
<code class="descname">marker_size</code><em class="property"> = 3.0</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.marker_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.marker_spin">
<code class="descname">marker_spin</code><em class="property"> = {0: u'^', 1: u'v'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.marker_spin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.nelect_in_spheres">
<code class="descname">nelect_in_spheres</code><span class="sig-paren">(</span><em>start_energy=None</em>, <em>stop_energy=None</em>, <em>method=u'gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.nelect_in_spheres"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.nelect_in_spheres" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the number of electrons inside each atom-centered sphere.
Note that this is a very crude estimate of the charge density distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>start_energy</strong> &#8211; PJDOS is integrated from this energy [eV]. If None, the lower bound in used.</li>
<li><strong>stop_energy</strong> &#8211; PJDOS is integrated up to this energy [eV]. If None, the Fermi level is used.</li>
<li><strong>method</strong> &#8211; String defining the method for the computation of the DOS.</li>
<li><strong>step</strong> &#8211; Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> &#8211; Standard deviation (eV) of the gaussian.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_lview">
<code class="descname">plot_fatbands_lview</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_lview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_lview" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the electronic fatbands grouped by L.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>fact:  float used to scale the stripe size.
axmat: Matrix of axes, if None new figure is produce.
ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">blist: List of band indices for the fatband plot. If None, all bands are included</p>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_mview">
<code class="descname">plot_fatbands_mview</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_mview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_mview" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the electronic fatbands grouped by LM.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">iatom: Index of the atom in the structure.
e0: Option used to define the zero of energy in the band structure plot. Possible values:</p>
<blockquote>
<div><ul class="simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</div></blockquote>
<p>fact:  float used to scale the stripe size.
ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">blist: List of band indices for the fatband plot. If None, all bands are included</p>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_siteview">
<code class="descname">plot_fatbands_siteview</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_siteview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_siteview" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot fatbands for each atom in the unit cell. By default, only the &#8220;inequivalent&#8221; atoms are shown.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>view: &#8220;inequivalent&#8221;, &#8220;all&#8221;
fact:  float used to scale the stripe size.
ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">blist: List of band indices for the fatband plot. If None, all bands are included</p>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_spinor">
<code class="descname">plot_fatbands_spinor</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_spinor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_spinor" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot spinor-resolved electronic fatbands. Require prtdos = 5 and nspinor = 2.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">terms: List of strings defining the quantities to plot. Possible values in:</p>
<blockquote>
<div>{&#8220;up-up&#8221;, &#8220;up-down&#8221;, &#8220;down-up&#8221;, &#8220;down-down&#8221;, &#8220;sigma_x&#8221;, &#8220;sigma_y&#8221;, &#8220;sigma_z&#8221;}</div></blockquote>
<dl class="docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>fact:  float used to scale the marker size.
axlist: List of matplotlib axes for plot. If None, new figure is produced
ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">blist: List of band indices for the fatband plot. If None, all bands are included</p>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_typeview">
<code class="descname">plot_fatbands_typeview</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_typeview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_typeview" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the electronic fatbands grouped by atomic type.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>fact:  float used to scale the stripe size.
axmat:
ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">blist: List of band indices for the fatband plot. If None, all bands are included</p>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_with_pjdos">
<code class="descname">plot_fatbands_with_pjdos</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_with_pjdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_with_pjdos" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Compute the fatbands and the PJDOS on the same figure, a.k.a the Sistine Chapel.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>fact:  float used to scale the stripe size.
blist: List of band indices for the fatband plot. If None, all bands are included
pjdosfile: FATBANDS file used to compute the PJDOS. If None, the PJDOS is taken from self.
edos_kwargs:
stacked:
width_ratio:
ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote class="last">
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_pawdos_terms">
<code class="descname">plot_pawdos_terms</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_pawdos_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_pawdos_terms" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot ...</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">method: String defining the method for the computation of the DOS.
step: Energy step (eV) of the linear mesh.
width: Standard deviation (eV) of the gaussian.
xlims: Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote class="last">
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_pjdos_lview">
<code class="descname">plot_pjdos_lview</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_pjdos_lview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_pjdos_lview" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the PJ-DOS on a linear mesh.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>method: String defining the method for the computation of the DOS.
step: Energy step (eV) of the linear mesh.
width: Standard deviation (eV) of the gaussian.
stacked: True if DOS curves
combined_spins: Define how up/down DOS components should be plotted when nsppol==2.</p>
<blockquote>
<div>If True, up/down DOSes are plotted on the same figure (positive values for up,
negative values for down component)
If False, up/down components are plotted on different axes.</div></blockquote>
<p>axmat:
exchange_xy: True if the dos should be plotted on the x axis instead of y.
xlims: Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">ylims: Same meaning as <cite>xlims</cite> but for the y-axis</p>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_pjdos_spinor">
<code class="descname">plot_pjdos_spinor</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_pjdos_spinor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_pjdos_spinor" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the PJ-DOS on a linear mesh.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">terms:
e0: Option used to define the zero of energy in the band structure plot. Possible values:</p>
<blockquote>
<div><ul class="simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</div></blockquote>
<p>method: String defining the method for the computation of the DOS.
step: Energy step (eV) of the linear mesh.
width: Standard deviation (eV) of the gaussian.
stacked: True if DOS curves
ax:
exchange_xy: True if the dos should be plotted on the x axis instead of y.
xlims: Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote class="last">
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_pjdos_typeview">
<code class="descname">plot_pjdos_typeview</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_pjdos_typeview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_pjdos_typeview" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the PJ-DOS on a linear mesh.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>method: String defining the method for the computation of the DOS.
step: Energy step (eV) of the linear mesh.
width: Standard deviation (eV) of the gaussian.
stacked: True if DOS curves
combined_spins: Define how up/down DOS components should be plotted when nsppol==2.</p>
<blockquote>
<div>If True, up/down DOSes are plotted on the same figure (positive values for up,
negative values for down component)
If False, up/down components are plotted on different axes.</div></blockquote>
<p>axmat:
exchange_xy: True if the dos should be plotted on the x axis instead of y.
xlims: Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">ylims: Same meaning as <cite>xlims</cite> but for the y-axis</p>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_spilling">
<code class="descname">plot_spilling</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_spilling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_spilling" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the electronic fatbands</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy.</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don&#8217;t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
<p>fact:  float used to scale the stripe size.
ylims: Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite></p>
<blockquote>
<div>or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</div></blockquote>
<p class="last">blist: List of band indices for the fatband plot. If None, all bands are included</p>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.spin2tex">
<code class="descname">spin2tex</code><em class="property"> = {0: u'$\\sigma=\\uparrow$', 1: u'$\\sigma=\\downarrow$'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.spin2tex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.spinors2color">
<code class="descname">spinors2color</code><em class="property"> = {u'sigma_z': u'red', u'sigma_y': u'blue', u'sigma_x': u'green', u'down-up': u'violet', u'up-up': u'black', u'up-down': u'brown', u'down-down': u'yellow'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.spinors2color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.spinors2tex">
<code class="descname">spinors2tex</code><em class="property"> = {u'sigma_z': u'$\\sigma_{z}$', u'sigma_y': u'$\\sigma_{y}$', u'sigma_x': u'$\\sigma_{x}$', u'down-up': u'$\\downarrow,\\uparrow$', u'up-up': u'$\\uparrow,\\uparrow$', u'up-down': u'$\\uparrow,\\downarrow$', u'down-down': u'$\\downarrow,\\downarrow$'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.spinors2tex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.wal_sbk">
<code class="descname">wal_sbk</code><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.wal_sbk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.wal_sbk" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of shape [natom, mbesslang, nsppol, mband, nkpt]
with the L-contributions. Present only if prtdos == 3.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.walm_sbk">
<code class="descname">walm_sbk</code><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.walm_sbk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.walm_sbk" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of shape [natom, mbesslang**2, nsppol, mband, nkpt]
with the LM-contribution. Present only if prtdos == 3 and prtdosm != 0</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an ipython notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.electrons.fatbands.gaussians_dos">
<code class="descclassname">abipy.electrons.fatbands.</code><code class="descname">gaussians_dos</code><span class="sig-paren">(</span><em>dos</em>, <em>mesh</em>, <em>width</em>, <em>values</em>, <em>energies</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#gaussians_dos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.gaussians_dos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-abipy.electrons.gsr">
<span id="gsr-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">gsr</span></code> Module<a class="headerlink" href="#module-abipy.electrons.gsr" title="Permalink to this headline">¶</a></h2>
<p>GSR file.</p>
<dl class="class">
<dt id="abipy.electrons.gsr.GsrFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.gsr.</code><code class="descname">GsrFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>File containing the results of a ground-state calculation.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">GsrFile</span><span class="p">(</span><span class="s2">&quot;foo_GSR.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">gsr</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;energy: &quot;</span><span class="p">,</span> <span class="n">gsr</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
    <span class="n">gsr</span><span class="o">.</span><span class="n">ebands</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.as_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.cart_forces">
<code class="descname">cart_forces</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.cart_forces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.cart_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian forces in eV / Ang</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.cart_stress_tensor">
<code class="descname">cart_stress_tensor</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.cart_stress_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.cart_stress_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Stress tensor in Ha/Bohr**3</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.ebands">
<code class="descname">ebands</code><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.ecut">
<code class="descname">ecut</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.ecut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.ecut" title="Permalink to this definition">¶</a></dt>
<dd><p>Cutoff energy in Hartree (Abinit input variable)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.energy">
<code class="descname">energy</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Total energy</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.energy_per_atom">
<code class="descname">energy_per_atom</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.energy_per_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.energy_per_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Total energy / number_of_atoms</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.energy_terms">
<code class="descname">energy_terms</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.energy_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.energy_terms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.force_stats">
<code class="descname">force_stats</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.force_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.force_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string with information on the forces.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.gsr.GsrFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.get_computed_entry">
<code class="descname">get_computed_entry</code><span class="sig-paren">(</span><em>inc_structure=False</em>, <em>parameters=None</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.get_computed_entry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.get_computed_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pymatgen <code class="xref py py-class docutils literal"><span class="pre">ComputedStructureEntry</span></code> from the GSR file.
Same API as the one used in vasp_output.get_computed_entry.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inc_structure</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to True if you want
ComputedStructureEntries to be returned instead of
ComputedEntries.</li>
<li><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; Input parameters to include. It has to be one of
the properties supported by the GSR object. If
parameters == None, a default set of parameters that are
necessary for typical post-processing will be set.</li>
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; Output data to include. Has to be one of the properties
supported by the GSR object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ComputedStructureEntry/ComputedEntry</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.is_scf_run">
<code class="descname">is_scf_run</code><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.is_scf_run" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the GSR has been produced by a SCF run.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.max_force">
<code class="descname">max_force</code><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.max_force" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.pawecutdg">
<code class="descname">pawecutdg</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.pawecutdg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.pawecutdg" title="Permalink to this definition">¶</a></dt>
<dd><p>Cutoff energy in Hartree for the PAW double grid (Abinit input variable)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.pressure">
<code class="descname">pressure</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.pressure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Pressure in Gpa</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.residm">
<code class="descname">residm</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.residm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.residm" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum of the residuals</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.tsmear">
<code class="descname">tsmear</code><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.tsmear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an ipython notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.xc">
<code class="descname">xc</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.xc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.xc" title="Permalink to this definition">¶</a></dt>
<dd><p><em>class</em> &#8211; <a href="#id2"><span class="problematic" id="id3">`</span></a>XcFunc object with info on the exchange-correlation functional.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.gsr.GsrPlotter">
<em class="property">class </em><code class="descclassname">abipy.electrons.gsr.</code><code class="descname">GsrPlotter</code><span class="sig-paren">(</span><em>*files</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">_abcoll.Iterable</span></code></p>
<p>This object receives a list of <cite>GsrFile</cite> objects and provides
methods to inspect/analyze the results (useful for convergence studies)</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">GsrPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="s2">&quot;foo_GSR.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="s2">&quot;bar_GSR.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">plot_variables</span><span class="p">(</span><span class="s2">&quot;ecut&quot;</span><span class="p">,</span> <span class="s2">&quot;etotal&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.gsr.GsrPlotter.add_file">
<code class="descname">add_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrPlotter.add_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.add_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a filename to the plotter</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrPlotter.add_files">
<code class="descname">add_files</code><span class="sig-paren">(</span><em>filepaths</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrPlotter.add_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.add_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a list of filenames to the plotter</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrPlotter.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrPlotter.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrPlotter.decorate_ax">
<code class="descname">decorate_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrPlotter.decorate_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.decorate_ax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrPlotter.filepaths">
<code class="descname">filepaths</code><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.filepaths" title="Permalink to this definition">¶</a></dt>
<dd><p>Filepaths of the GSR files.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrPlotter.param_name">
<code class="descname">param_name</code><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.param_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the parameter whose value is checked for convergence.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrPlotter.plot_variables">
<code class="descname">plot_variables</code><span class="sig-paren">(</span><em>varname_x</em>, <em>varname_y</em>, <em>hspan=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrPlotter.plot_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.plot_variables" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Ex:</dt>
<dd>plot_variables(&#8220;ecut&#8221;, &#8220;etotal&#8221;)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrPlotter.prepare_plot">
<code class="descname">prepare_plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrPlotter.prepare_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.prepare_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>This method must be called before plotting data.
It tries to figure the name of parameter we are converging
by looking at the set of parameters used to compute the different GSR files.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrPlotter.set_param_name">
<code class="descname">set_param_name</code><span class="sig-paren">(</span><em>param_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrPlotter.set_param_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.set_param_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the name of the parameter whose value is checked for convergence.
if param_name is None, we try to find its name by inspecting
the values in the gsr.params dictionaries.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrPlotter.set_xvalues">
<code class="descname">set_xvalues</code><span class="sig-paren">(</span><em>xvalues</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrPlotter.set_xvalues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.set_xvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>xvalues setter.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrPlotter.xvalues">
<code class="descname">xvalues</code><a class="headerlink" href="#abipy.electrons.gsr.GsrPlotter.xvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>The values used for the X-axis.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.gw">
<span id="gw-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">gw</span></code> Module<a class="headerlink" href="#module-abipy.electrons.gw" title="Permalink to this headline">¶</a></h2>
<p>Classes for the analysis of GW calculations.</p>
<dl class="class">
<dt id="abipy.electrons.gw.QPState">
<em class="property">class </em><code class="descclassname">abipy.electrons.gw.</code><code class="descname">QPState</code><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.gw.QPState</span></code></a></p>
<p>Quasi-particle result for given (spin, kpoint, band).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Energies are in eV.</p>
</div>
<dl class="classmethod">
<dt id="abipy.electrons.gw.QPState.TIPS">
<em class="property">classmethod </em><code class="descname">TIPS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.TIPS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.TIPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Class method that returns a dictionary with the description of the fields.
The string are extracted from the class doc string.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.QPState.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert self into a dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.QPState.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.gw.QPState.get_fields">
<em class="property">classmethod </em><code class="descname">get_fields</code><span class="sig-paren">(</span><em>exclude=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.get_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.get_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.QPState.qpeme0">
<code class="descname">qpeme0</code><a class="headerlink" href="#abipy.electrons.gw.QPState.qpeme0" title="Permalink to this definition">¶</a></dt>
<dd><p>E_QP - E_0</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.QPState.skb">
<code class="descname">skb</code><a class="headerlink" href="#abipy.electrons.gw.QPState.skb" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple with (spin, kpoint, band)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.QPState.tips">
<code class="descname">tips</code><a class="headerlink" href="#abipy.electrons.gw.QPState.tips" title="Permalink to this definition">¶</a></dt>
<dd><p>Bound method of self that returns a dictionary with the description of the fields.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.QPState.to_strdict">
<code class="descname">to_strdict</code><span class="sig-paren">(</span><em>fmt=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.to_strdict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.to_strdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered dictionary mapping fields &#8211;&gt; strings.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.gw.SigresFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.gw.</code><code class="descname">SigresFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Container storing the GW results reported in the SIGRES.nc file.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">sigres</span> <span class="o">=</span> <span class="n">SigresFile</span><span class="p">(</span><span class="s2">&quot;foo_SIGRES.nc&quot;</span><span class="p">)</span>
<span class="n">sigres</span><span class="o">.</span><span class="n">plot_qps_vs_e0</span><span class="p">()</span>
<span class="n">sigres</span><span class="o">.</span><span class="n">plot_ksbands_with_qpmarkers</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the netcdf file.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.ebands">
<code class="descname">ebands</code><a class="headerlink" href="#abipy.electrons.gw.SigresFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>ElectronBands</cite> with the KS energies.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.gw.SigresFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an instance from file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_dataframe_sk">
<code class="descname">get_dataframe_sk</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>index=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_dataframe_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_dataframe_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns pandas DataFrame with QP results for the given (spin, k-point).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_qpcorr">
<code class="descname">get_qpcorr</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_qpcorr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_qpcorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal"><span class="pre">QPState</span></code></a> object for the given (s, k, b)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_qpgap">
<code class="descname">get_qpgap</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_qpgap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_qpgap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_qplist">
<code class="descname">get_qplist</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_qplist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_qplist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_sigmaw">
<code class="descname">get_sigmaw</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_sigmaw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_sigmaw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_spfunc">
<code class="descname">get_spfunc</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_spfunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_spfunc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.interpolate">
<code class="descname">interpolate</code><span class="sig-paren">(</span><em>lpratio=5</em>, <em>ks_ebands_kpath=None</em>, <em>ks_ebands_kmesh=None</em>, <em>ks_degatol=0.0001</em>, <em>vertices_names=None</em>, <em>line_density=20</em>, <em>filter_params=None</em>, <em>only_corrections=False</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolated the GW corrections in k-space on a k-path and, optionally, on a k-mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lpratio</strong> &#8211; Ratio between the number of star functions and the number of ab-initio k-points.
The default should be OK in many systems, larger values may be required for accurate derivatives.</li>
<li><strong>ks_ebands_kpath</strong> &#8211; KS <code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code> on a k-path. If present,
the routine interpolates the QP corrections and apply them on top of the KS band structure
This is the recommended option because QP corrections are usually smoother than the
QP energies and therefore easier to interpolate. If None, the QP energies are interpolated
along the path defined by <cite>vertices_names</cite> and <cite>line_density</cite>.</li>
<li><strong>ks_ebands_kmesh</strong> &#8211; KS <code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code> on a homogeneous k-mesh. If present, the routine
interpolates the corrections on the k-mesh (used to compute QP DOS)</li>
<li><strong>ks_degatol</strong> &#8211; Energy tolerance in eV. Used when either <cite>ks_ebands_kpath</cite> or <cite>ks_ebands_kmesh</cite> are given.
KS energies are assumed to be degenerate if they differ by less than this value.
The interpolator may break band degeneracies (the error is usually smaller if QP corrections
are interpolated instead of QP energies). This problem can be partly solved by averaging
the interpolated values over the set of KS degenerate states.
A negative value disables this ad-hoc symmetrization.</li>
<li><strong>vertices_names</strong> &#8211; Used to specify the k-path for the interpolated QP band structure
when <cite>ks_ebands_kpath</cite> is None.
It&#8217;s a list of tuple, each tuple is of the form (kfrac_coords, kname) where
kfrac_coords are the reduced coordinates of the k-point and kname is a string with the name of
the k-point. Each point represents a vertex of the k-path. <cite>line_density</cite> defines
the density of the sampling. If None, the k-path is automatically generated according
to the point group of the system.</li>
<li><strong>line_density</strong> &#8211; Number of points in the smallest segment of the k-path. Used with <cite>vertices_names</cite>.</li>
<li><strong>filter_params</strong> &#8211; TO BE DESCRIBED</li>
<li><strong>only_corrections</strong> &#8211; If True, the output contains the interpolated QP corrections instead of the QP energies.
Available only if ks_ebands_kpath and/or ks_ebands_kmesh are used.</li>
<li><strong>verbose</strong> &#8211; Verbosity level</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>qp_ebands_kpath: <code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code> with the QP energies interpolated along the k-path.
qp_ebands_kmesh: <code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code> with the QP energies interpolated on the k-mesh.</p>
<blockquote>
<div><p>None if <cite>ks_ebands_kmesh</cite> is not passed.</p>
</div></blockquote>
<p>ks_ebands_kpath: <code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code> with the KS energies interpolated along the k-path.
ks_ebands_kmesh: <code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code> with the KS energies on the k-mesh..</p>
<blockquote>
<div><p>None if <cite>ks_ebands_kmesh</cite> is not passed.</p>
</div></blockquote>
<p>interpolator: <code class="xref py py-class docutils literal"><span class="pre">SkwInterpolator</span></code> object.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal"><span class="pre">namedtuple</span></code> with the following attributes</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p>AttrDict dictionary with the GW convergence parameters, e.g. ecuteps</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.plot_eigvec_qp">
<code class="descname">plot_eigvec_qp</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_eigvec_qp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_eigvec_qp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.plot_ksbands_with_qpmarkers">
<code class="descname">plot_ksbands_with_qpmarkers</code><span class="sig-paren">(</span><em>qpattr=u'qpeme0'</em>, <em>fact=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_ksbands_with_qpmarkers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_ksbands_with_qpmarkers" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the KS energies as function an k and add markers
whose size is proportional to QPState attribute qpattr</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.plot_qps_vs_e0">
<code class="descname">plot_qps_vs_e0</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_qps_vs_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_qps_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot QP data as function of the KS energy.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>with_fields: The names of the qp attributes to plot as function of e0.</dt>
<dd>Accepts: List of strings or string with tokens separated by blanks.
See <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal"><span class="pre">QPState</span></code></a> for the list of available fields.</dd>
</dl>
<p class="last">exclude_fields: Similar to <cite>with_field</cite> but excludes fields
axlist: List of matplotlib axes for plot. If None, new figure is produced
label: Label for plot.</p>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.plot_spectral_functions">
<code class="descname">plot_spectral_functions</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_spectral_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_spectral_functions" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><dl class="docutils">
<dt>Args:</dt>
<dd>spin: Spin index.
kpoint: Required kpoint.
bands: List of bands
ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.print_qps">
<code class="descname">print_qps</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.gw.SigresFile.print_qps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.qpgaps">
<code class="descname">qpgaps</code><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.qpgaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.qpgaps" title="Permalink to this definition">¶</a></dt>
<dd><p>ndarray with shape [nsppol, nkibz] in eV</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.qplist_spin">
<code class="descname">qplist_spin</code><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.qplist_spin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.qplist_spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of <code class="xref py py-class docutils literal"><span class="pre">QPList</span></code> objects indexed by spin.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.gw.SigresFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure` instance.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an ipython notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.gw.SigresPlotter">
<em class="property">class </em><code class="descclassname">abipy.electrons.gw.</code><code class="descname">SigresPlotter</code><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">_abcoll.Iterable</span></code></p>
<p>This object receives a list of <a class="reference internal" href="#abipy.electrons.gw.SigresFile" title="abipy.electrons.gw.SigresFile"><code class="xref py py-class docutils literal"><span class="pre">SigresFile</span></code></a> objects and provides methods
to inspect/analyze the GW results (useful for convergence studies)</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">SigresPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="s2">&quot;foo_SIGRES.nc&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;foo bands&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="s2">&quot;bar_SIGRES.nc&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bar bands&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">plot_qpgaps</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.add_file">
<code class="descname">add_file</code><span class="sig-paren">(</span><em>filepath</em>, <em>label=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.add_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.add_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a filename to the plotter</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.add_files">
<code class="descname">add_files</code><span class="sig-paren">(</span><em>filepaths</em>, <em>labels=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.add_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.add_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a list of filenames to the plotter</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.decorate_ax">
<code class="descname">decorate_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.decorate_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.decorate_ax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.extract_qpenes">
<code class="descname">extract_qpenes</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.extract_qpenes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.extract_qpenes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <cite>ndarray</cite> with the QP energies for the given spin, kpoint.
Values are ordered with the list of SIGRES files in self.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.extract_qpgaps">
<code class="descname">extract_qpgaps</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.extract_qpgaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.extract_qpgaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <cite>ndarray</cite> with the QP gaps for the given spin, kpoint.
Values are ordered with the list of SIGRES files in self.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresPlotter.param_name">
<code class="descname">param_name</code><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.param_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the parameter whose value is checked for convergence.
This attribute is automatically individuated by inspecting the differences
inf the sigres.params dictionaries of the files provided.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.plot_qpenes">
<code class="descname">plot_qpenes</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.plot_qpenes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.plot_qpenes" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the QP energies as function of the convergence parameter.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>spin:
kpoint:
band:
hspan:
kwargs:</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.plot_qpgaps">
<code class="descname">plot_qpgaps</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.plot_qpgaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.plot_qpgaps" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the QP gaps as function of the convergence parameter.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
spin:
kpoint:
hspan:
kwargs:</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.plot_qps_vs_e0">
<code class="descname">plot_qps_vs_e0</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.plot_qps_vs_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.plot_qps_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the QP results as function of the initial KS energy for all SIGRES files stored in the plotter.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>with_fields: The names of the qp attributes to plot as function of e0.</dt>
<dd>Accepts: List of strings or string with tokens separated by blanks.
See <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal"><span class="pre">QPState</span></code></a> for the list of available fields.</dd>
</dl>
<p class="last">exclude_fields: Similar to <cite>with_field</cite> but excludes fields
axlist: List of matplotlib axes for plot. If None, new figure is produced</p>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.prepare_plot">
<code class="descname">prepare_plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.prepare_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.prepare_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>This method must be called before plotting data.
It tries to figure the name of paramenter we are converging
by looking at the set of parameters used to compute the different SIGRES files.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.set_param_name">
<code class="descname">set_param_name</code><span class="sig-paren">(</span><em>param_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.set_param_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.set_param_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the name of the parameter whose value is checked for convergence.
if param_name is None, we try to find its name by inspecting
the values in the sigres.params dictionaries.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresPlotter.set_xvalues">
<code class="descname">set_xvalues</code><span class="sig-paren">(</span><em>xvalues</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresPlotter.set_xvalues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.set_xvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>xvalues setter.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresPlotter.xvalues">
<code class="descname">xvalues</code><a class="headerlink" href="#abipy.electrons.gw.SigresPlotter.xvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>The values used for the X-axis.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.denpot">
<span id="denpot-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">denpot</span></code> Module<a class="headerlink" href="#module-abipy.electrons.denpot" title="Permalink to this headline">¶</a></h2>
<p>Density/potential files in netcdf format.</p>
<dl class="class">
<dt id="abipy.electrons.denpot.DensityNcFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.denpot.</code><code class="descname">DensityNcFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Netcdf File containing the electronic density.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">DensityNcFile</span><span class="p">(</span><span class="s2">&quot;foo_DEN.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
    <span class="n">ncfile</span><span class="o">.</span><span class="n">density</span>
    <span class="n">ncfile</span><span class="o">.</span><span class="n">ebands</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.denpot.DensityNcFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.denpot.DensityNcFile.density">
<code class="descname">density</code><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.density" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.denpot.DensityNcFile.ebands">
<code class="descname">ebands</code><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code> object.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.denpot.DensityNcFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.denpot.DensityNcFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.denpot.DensityNcFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.denpot.DensityNcFile.write_chgcar">
<code class="descname">write_chgcar</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.write_chgcar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.write_chgcar" title="Permalink to this definition">¶</a></dt>
<dd><p>Write density in CHGCAR format. Return <code class="xref py py-class docutils literal"><span class="pre">ChgCar</span></code> instance.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.denpot.DensityNcFile.write_cube">
<code class="descname">write_cube</code><span class="sig-paren">(</span><em>filename=None</em>, <em>spin=u'total'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.write_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.write_cube" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.denpot.DensityNcFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an ipython notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.denpot.DensityNcFile.write_xsf">
<code class="descname">write_xsf</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.write_xsf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.write_xsf" title="Permalink to this definition">¶</a></dt>
<dd><p>Write density in XSF format.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.denpot.DensityNcFile.xc">
<code class="descname">xc</code><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.xc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.xc" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">XcFunc</span></code> object with info on the exchange-correlation functional.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.psps">
<span id="psps-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">psps</span></code> Module<a class="headerlink" href="#module-abipy.electrons.psps" title="Permalink to this headline">¶</a></h2>
<p>PSPS file with tabulated data.</p>
<dl class="class">
<dt id="abipy.electrons.psps.PspsFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.psps.</code><code class="descname">PspsFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a></p>
<p>Netcdf file with the tables used in Abinit to apply the
pseudopotential part of the KS Hamiltonian.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">PspsFile</span><span class="p">(</span><span class="s2">&quot;foo_PSPS.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">psps</span><span class="p">:</span>
    <span class="n">psps</span><span class="o">.</span><span class="n">plot_tcore_rspace</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.psps.PspsFile.color_der">
<code class="descname">color_der</code><em class="property"> = [u'black', u'red', u'green', u'orange', u'cyan']</em><a class="headerlink" href="#abipy.electrons.psps.PspsFile.color_der" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.compare">
<code class="descname">compare</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.compare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce matplotlib plot comparing self with another list of pseudos <cite>others</cite>.</p>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.psps.PspsFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.psps.PspsFile.linestyles_der">
<code class="descname">linestyles_der</code><em class="property"> = [u'-', u'--', u'-.', u':', u':', u':']</em><a class="headerlink" href="#abipy.electrons.psps.PspsFile.linestyles_der" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Driver routine to plot several quantities on the same graph.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ecut_ffnl: Max cutoff energy for ffnl plot (optional)</dd>
</dl>
<p>Return: matplotlb Figure</p>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.plot_ffspl">
<code class="descname">plot_ffspl</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_ffspl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_ffspl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the nonlocal part of the pseudopotential in q space.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
ecut_ffnl: Max cutoff energy for ffnl plot (optional)
ders: Tuple used to select the derivatives to be plotted.
with_qn:</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.plot_tcore_qspace">
<code class="descname">plot_tcore_qspace</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_tcore_qspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_tcore_qspace" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the model core in q space</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
ders: Tuple used to select the derivatives to be plotted.
with_qn:</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.plot_tcore_rspace">
<code class="descname">plot_tcore_rspace</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_tcore_rspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_tcore_rspace" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the model core and its derivatives in real space.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
ders: Tuple used to select the derivatives to be plotted.
rmax: Max radius for plot in Bohr. None is full grid is wanted.</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.plot_vlocq">
<code class="descname">plot_vlocq</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_vlocq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_vlocq" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the local part of the pseudopotential in q space.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
ders: Tuple used to select the derivatives to be plotted.
with_qn:</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.psps.PspsReader">
<em class="property">class </em><code class="descclassname">abipy.electrons.psps.</code><code class="descname">PspsReader</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads the results stored in the PSPS file produced by ABINIT.
It provides helper function to access the most important quantities.</p>
<dl class="method">
<dt id="abipy.electrons.psps.PspsReader.get_lnlist_for_type">
<code class="descname">get_lnlist_for_type</code><span class="sig-paren">(</span><em>itypat</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.get_lnlist_for_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.get_lnlist_for_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of (l, n) indices for this atom type.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsReader.read_coresd">
<code class="descname">read_coresd</code><span class="sig-paren">(</span><em>rmax=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_coresd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_coresd" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the core charges and derivatives for the different types of atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rmax</strong> &#8211; Maximum radius in Bohr. If None, data on the full grid is returned.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of ntypat arrays. Each array contains the linear meshes in real space.
coresd: List with nytpat arrays of shape [6, npts].<p>(np.zeros. np.zeros) if core charge is not present</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">meshes</td>
</tr>
</tbody>
</table>
<p>xccc1d[ntypat6,n1xccc*(1-usepaw)]</p>
<p>Norm-conserving psps only
The component xccc1d(n1xccc,1,ntypat) is the pseudo-core charge
for each type of atom, on the radial grid. The components
xccc1d(n1xccc,ideriv,ntypat) give the ideriv-th derivative of the
pseudo-core charge with respect to the radial distance.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsReader.read_projectors">
<code class="descname">read_projectors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_projectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_projectors" title="Permalink to this definition">¶</a></dt>
<dd><p>ffspl(ntypat, lnmax, 2, mqgrid_ff]
Gives, on the radial grid, the different non-local projectors,
in both the norm-conserving case, and the PAW case</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsReader.read_tcorespl">
<code class="descname">read_tcorespl</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_tcorespl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_tcorespl" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Linear q-mesh in G-space
tcorespl:</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">qmesh</td>
</tr>
</tbody>
</table>
<p>tcorespl[ntypat, 2, mqgrid_vl]
Gives the pseudo core density in reciprocal space on a regular grid.
Only if has_tcore</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsReader.read_vlspl">
<code class="descname">read_vlspl</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_vlspl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_vlspl" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Linear q-mesh in G-space
vlspl:</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">qmesh</td>
</tr>
</tbody>
</table>
<p>vlspl[2, ntypat, mqgrid_vl]
Gives, on the radial grid, the local part of each type of psp.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.psps.VnlProjector">
<em class="property">class </em><code class="descclassname">abipy.electrons.psps.</code><code class="descname">VnlProjector</code><span class="sig-paren">(</span><em>itypat</em>, <em>ln</em>, <em>ekb</em>, <em>qmesh</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#VnlProjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.VnlProjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Data and parameters associated to a non-local projector.</p>
<dl class="attribute">
<dt id="abipy.electrons.psps.VnlProjector.der2">
<code class="descname">der2</code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.der2" title="Permalink to this definition">¶</a></dt>
<dd><p>Second order derivative.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.psps.VnlProjector.ecuts">
<code class="descname">ecuts</code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.ecuts" title="Permalink to this definition">¶</a></dt>
<dd><p>List of cutoff energies corresponding to self.qmesh.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.psps.VnlProjector.sign_sqrtekb">
<code class="descname">sign_sqrtekb</code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.sign_sqrtekb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.psps.VnlProjector.values">
<code class="descname">values</code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Values of the projector in q-space.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.electrons.psps.compare_pseudos">
<code class="descclassname">abipy.electrons.psps.</code><code class="descname">compare_pseudos</code><span class="sig-paren">(</span><em>filepaths</em>, <em>ecut=30</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#compare_pseudos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.compare_pseudos" title="Permalink to this definition">¶</a></dt>
<dd><p>This function receives a list of pseudopotential files, call
Abinit to produced the PSPS.nc files and produces matplotlib plots
comparing the behaviour of the pseudos in real and in reciprocal space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filepaths</strong> &#8211; List of file names.</li>
<li><strong>ecut</strong> &#8211; Cutoff energy in Ha for the wavefunctions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="abipy.electrons.psps.mklabel">
<code class="descclassname">abipy.electrons.psps.</code><code class="descname">mklabel</code><span class="sig-paren">(</span><em>fsym</em>, <em>der</em>, <em>arg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#mklabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.mklabel" title="Permalink to this definition">¶</a></dt>
<dd><p>mklabel(f, 2, x) &#8211;&gt; $f&#8217;&#8216;(x)$</p>
</dd></dl>

<dl class="function">
<dt id="abipy.electrons.psps.rescale">
<code class="descclassname">abipy.electrons.psps.</code><code class="descname">rescale</code><span class="sig-paren">(</span><em>arr</em>, <em>scale=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#rescale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.rescale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-abipy.electrons.scissors">
<span id="scissors-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">scissors</span></code> Module<a class="headerlink" href="#module-abipy.electrons.scissors" title="Permalink to this headline">¶</a></h2>
<p>Scissors operator.</p>
<dl class="class">
<dt id="abipy.electrons.scissors.Scissors">
<em class="property">class </em><code class="descclassname">abipy.electrons.scissors.</code><code class="descname">Scissors</code><span class="sig-paren">(</span><em>func_list</em>, <em>domains</em>, <em>residues</em>, <em>bounds=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#Scissors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.Scissors" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object represents an energy-dependent scissors operator. The operator is defined by a list of domains
(energy intervals) and a list of functions defined in these domains. The domains should fulfill the constraints
documented in the main constructor.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">eV units are assumed.</p>
</div>
<p>The standard way to create this object is via the methods provided by the factory class <code class="xref py py-class docutils literal"><span class="pre">ScissorBuilder</span></code>.
Once the instance has been created, one can correct the band structure by calling the <cite>apply</cite> method.</p>
<dl class="attribute">
<dt id="abipy.electrons.scissors.Scissors.Error">
<code class="descname">Error</code><a class="headerlink" href="#abipy.electrons.scissors.Scissors.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ScissorsError</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.Scissors.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>eig</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#Scissors.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.Scissors.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the eigenvalue eig (eV units).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scissors.ScissorsBuilder">
<em class="property">class </em><code class="descclassname">abipy.electrons.scissors.</code><code class="descname">ScissorsBuilder</code><span class="sig-paren">(</span><em>qps_spin</em>, <em>sigres_ebands</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object facilitates the creation of <a class="reference internal" href="#abipy.electrons.scissors.Scissors" title="abipy.electrons.scissors.Scissors"><code class="xref py py-class docutils literal"><span class="pre">Scissors</span></code></a> instances.</p>
<p>Usage:</p>
<blockquote>
<div><p>builder = ScissorsBuilder.from_file(&#8220;sigres_file&#8221;)</p>
<p># To plot the QP results as function of the KS energy:
builder.plot_qpe_vs_e0()</p>
<p># To select the domains esplicitly (optional)
builder.build(domains_spin=[[-10, 6.02], [6.1, 20]])</p>
<p># To compare the fitted results with the ab-initio data:
builder.plot_fit()</p>
<p># To plot the corrected bands:
builder.plot_qpbands(abidata.ref_file(&#8220;si_nscf_WFK-etsf.nc&#8221;))</p>
</div></blockquote>
<dl class="method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>domains_spin=None</em>, <em>bounds_spin=None</em>, <em>k=3</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the scissors operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domains_spin</strong> &#8211; list of domains in eV for each spin. If domains is None,
domains are computed automatically from the sigres bands
(two domains separated by the middle of the gap).</li>
<li><strong>bounds_spin</strong> &#8211; Options specifying the boundary conditions (not used at present)</li>
<li><strong>k</strong> &#8211; Parameter defining the order of the fit.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scissors.ScissorsBuilder.e0max">
<code class="descname">e0max</code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.e0max" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum KS energy in eV (takes into account spin)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scissors.ScissorsBuilder.e0min">
<code class="descname">e0min</code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.e0min" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum KS energy in eV (takes into account spin)</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.scissors.ScissorsBuilder.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an instance of <cite>ScissorsBuilder</cite> from file. Main entry point for client code.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scissors.ScissorsBuilder.nsppol">
<code class="descname">nsppol</code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.nsppol" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of spins.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.pickle_dump">
<code class="descname">pickle_dump</code><span class="sig-paren">(</span><em>filepath</em>, <em>protocol=-1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.pickle_dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.pickle_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the object in Pickle format</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.scissors.ScissorsBuilder.pickle_load">
<em class="property">classmethod </em><code class="descname">pickle_load</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.pickle_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.pickle_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the object from a pickle file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.plot_fit">
<code class="descname">plot_fit</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.plot_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Compare fit functions with input quasi-particle corrections.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.plot_qpbands">
<code class="descname">plot_qpbands</code><span class="sig-paren">(</span><em>bands_filepath</em>, <em>bands_label=None</em>, <em>dos_filepath=None</em>, <em>dos_args=None</em>, <em>qp_marker=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.plot_qpbands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.plot_qpbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the energies found in the netcdf file bands_filepath and plot the band energies (both the initial
and the corrected ones) with matplotlib. The plot contains the KS and the QP DOS if dos_filepath is not None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bands_filepath</strong> &#8211; Path to the netcdf file containing the initial KS energies to be corrected.</li>
<li><strong>String used to label the KS bands in the plot.</strong> (<em>bands_label</em>) &#8211; </li>
<li><strong>dos_filepath</strong> &#8211; Optional path to a netcdf file with the initial KS energies on a homogeneous k-mesh
(used to compute the KS and the QP dos)</li>
<li><strong>dos_args</strong> &#8211; Dictionary with the arguments passed to get_dos to compute the DOS
Used if dos_filepath is not None.</li>
<li><strong>qp_marker</strong> &#8211; if int &gt; 0, markers for the ab-initio QP energies are displayed. e.g qp_marker=50</li>
<li><strong>kwargs</strong> &#8211; Options passed to the plotter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">matplotlib figure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.plot_qpe_vs_e0">
<code class="descname">plot_qpe_vs_e0</code><span class="sig-paren">(</span><em>with_fields=u'all'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.plot_qpe_vs_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.plot_qpe_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the quasiparticle corrections as function of the KS energy.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scissors.ScissorsBuilder.scissors_spin">
<code class="descname">scissors_spin</code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.scissors_spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of <a class="reference internal" href="#abipy.electrons.scissors.Scissors" title="abipy.electrons.scissors.Scissors"><code class="xref py py-class docutils literal"><span class="pre">Scissors</span></code></a> indexed by the spin value.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.scr">
<span id="scr-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">scr</span></code> Module<a class="headerlink" href="#module-abipy.electrons.scr" title="Permalink to this headline">¶</a></h2>
<p>Objects to analyze the screening file produced by ABINIT.</p>
<dl class="class">
<dt id="abipy.electrons.scr.DielectricFunction">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">DielectricFunction</code><span class="sig-paren">(</span><em>qpoint</em>, <em>wpts</em>, <em>gsphere</em>, <em>wggmat</em>, <em>inord=u'C'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#DielectricFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.DielectricFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.electrons.scr.WGGFunction" title="abipy.electrons.scr.WGGFunction"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.scr.WGGFunction</span></code></a></p>
<dl class="attribute">
<dt id="abipy.electrons.scr.DielectricFunction.etsf_name">
<code class="descname">etsf_name</code><em class="property"> = u'dielectric_function'</em><a class="headerlink" href="#abipy.electrons.scr.DielectricFunction.etsf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.DielectricFunction.latex_name">
<code class="descname">latex_name</code><em class="property"> = u'\\epsilon'</em><a class="headerlink" href="#abipy.electrons.scr.DielectricFunction.latex_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.GodbyNeeds">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">GodbyNeeds</code><span class="sig-paren">(</span><em>gsphere</em>, <em>omegatw</em>, <em>bigomegatwsq</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#GodbyNeeds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.GodbyNeeds" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.electrons.scr.PPModel" title="abipy.electrons.scr.PPModel"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.scr.PPModel</span></code></a></p>
<dl class="method">
<dt id="abipy.electrons.scr.GodbyNeeds.eval_em1">
<code class="descname">eval_em1</code><span class="sig-paren">(</span><em>omegas</em>, <em>zcut</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#GodbyNeeds.eval_em1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.GodbyNeeds.eval_em1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.scr.GodbyNeeds.from_em1">
<em class="property">classmethod </em><code class="descname">from_em1</code><span class="sig-paren">(</span><em>em1</em>, <em>wplasma</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#GodbyNeeds.from_em1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.GodbyNeeds.from_em1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.GodbyNeeds.plot_ggparams">
<code class="descname">plot_ggparams</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#GodbyNeeds.plot_ggparams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.GodbyNeeds.plot_ggparams" title="Permalink to this definition">¶</a></dt>
<dd><p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.InverseDielectricFunction">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">InverseDielectricFunction</code><span class="sig-paren">(</span><em>qpoint</em>, <em>wpts</em>, <em>gsphere</em>, <em>wggmat</em>, <em>inord=u'C'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#InverseDielectricFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.electrons.scr.WGGFunction" title="abipy.electrons.scr.WGGFunction"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.scr.WGGFunction</span></code></a></p>
<dl class="method">
<dt id="abipy.electrons.scr.InverseDielectricFunction.build_godby_needs_ppmodel">
<code class="descname">build_godby_needs_ppmodel</code><span class="sig-paren">(</span><em>wplasma</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#InverseDielectricFunction.build_godby_needs_ppmodel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction.build_godby_needs_ppmodel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.InverseDielectricFunction.etsf_name">
<code class="descname">etsf_name</code><em class="property"> = u'inverse_dielectric_function'</em><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction.etsf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.InverseDielectricFunction.latex_name">
<code class="descname">latex_name</code><em class="property"> = u'\\epsilon^{-1}'</em><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction.latex_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.InverseDielectricFunction.plot_with_ppmodels">
<code class="descname">plot_with_ppmodels</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#InverseDielectricFunction.plot_with_ppmodels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction.plot_with_ppmodels" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">gvec1, gvec2:
waxis: &#8220;real&#8221; to plot along the real axis, &#8220;imag&#8221; for the imaginary axis.
cplx_mode: string defining the data to print.</p>
<blockquote>
<div>Possible choices are (case-insensitive): <cite>re</cite> for the real part
&#8220;im&#8221; for the imaginary part, &#8220;abs&#8221; for the absolute value.
&#8220;angle&#8221; will display the phase of the complex number in radians.
Options can be concatenated with &#8220;-&#8221; e.g. &#8220;re-im&#8221;</div></blockquote>
<p class="last">zcut: Small shift along the imaginary axis to avoid poles. 0.1 eV is the Abinit default.
ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</p>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.PPModel">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">PPModel</code><a class="reference internal" href="../_modules/abipy/electrons/scr.html#PPModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.PPModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<dl class="method">
<dt id="abipy.electrons.scr.PPModel.eval_em1">
<code class="descname">eval_em1</code><span class="sig-paren">(</span><em>omegas</em>, <em>zcut</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#PPModel.eval_em1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.PPModel.eval_em1" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the plasmon-pole model at frequency omega (Ha units).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.Polarizability">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">Polarizability</code><span class="sig-paren">(</span><em>qpoint</em>, <em>wpts</em>, <em>gsphere</em>, <em>wggmat</em>, <em>inord=u'C'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#Polarizability"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.Polarizability" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.electrons.scr.WGGFunction" title="abipy.electrons.scr.WGGFunction"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.scr.WGGFunction</span></code></a></p>
<dl class="attribute">
<dt id="abipy.electrons.scr.Polarizability.etsf_name">
<code class="descname">etsf_name</code><em class="property"> = u'dielectric_function'</em><a class="headerlink" href="#abipy.electrons.scr.Polarizability.etsf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.Polarizability.latex_name">
<code class="descname">latex_name</code><em class="property"> = u'\\tilde chi'</em><a class="headerlink" href="#abipy.electrons.scr.Polarizability.latex_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.ScrFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">ScrFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Netcdf file with the tables used in Abinit to apply the
pseudopotential part of the KS Hamiltonian.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ScrFile</span><span class="p">(</span><span class="s2">&quot;foo_SCR.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">scr</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">scr</span><span class="p">)</span>
    <span class="n">em1</span> <span class="o">=</span> <span class="n">scr</span><span class="o">.</span><span class="n">get_em1</span><span class="p">(</span><span class="n">qpoint</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">em1</span><span class="o">.</span><span class="n">plot_w</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.scr.ScrFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.get_em1">
<code class="descname">get_em1</code><span class="sig-paren">(</span><em>qpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.get_em1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.get_em1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.get_emacro_lf">
<code class="descname">get_emacro_lf</code><span class="sig-paren">(</span><em>qpoint=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.get_emacro_lf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.get_emacro_lf" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the macroscopic dielectric function <em>with</em> local field effects
1/ em1_{0,0)(q=0, w).</p>
<p>Return <code class="xref py py-class docutils literal"><span class="pre">Function1D</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.get_emacro_nlf">
<code class="descname">get_emacro_nlf</code><span class="sig-paren">(</span><em>qpoint=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.get_emacro_nlf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.get_emacro_nlf" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the macroscopic dielectric function <em>without</em> local field effects.
e_{0,0)(q=0, w).</p>
<p>Return <code class="xref py py-class docutils literal"><span class="pre">Function1D</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.plot_emacro_lf">
<code class="descname">plot_emacro_lf</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.plot_emacro_lf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.plot_emacro_lf" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the macroscopic dielectric function with local-field effects.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.qpoints">
<code class="descname">qpoints</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>List of q-points for the dielectric function.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Crystalline structure.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.wpts">
<code class="descname">wpts</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.wpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the frequencies of the dielectric function in Ha.
Returns numpy array of complex numbers.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an ipython notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.ScrReader">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">ScrReader</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads the results stored in the SCR (Screening) file produced by ABINIT.
It provides helper functions to access the most important quantities.</p>
<dl class="method">
<dt id="abipy.electrons.scr.ScrReader.find_qpoint_fileindex">
<code class="descname">find_qpoint_fileindex</code><span class="sig-paren">(</span><em>qpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.find_qpoint_fileindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.find_qpoint_fileindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the q-point and the index of in the netcdf file.
Accepts <cite>Kpoint</cite> instance or integer</p>
<dl class="docutils">
<dt>Raise:</dt>
<dd><cite>KpointsError</cite> if qpoint cannot be found.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrReader.read_wggfunc">
<code class="descname">read_wggfunc</code><span class="sig-paren">(</span><em>qpoint</em>, <em>cls</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_wggfunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_wggfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data at the given q-point and return an instance
of <cite>cls</cite> where <cite>cls</cite> is a subclass of <cite>WGGFunction</cite></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.WGGFunction">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">WGGFunction</code><span class="sig-paren">(</span><em>qpoint</em>, <em>wpts</em>, <em>gsphere</em>, <em>wggmat</em>, <em>inord=u'C'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#WGGFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.WGGFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Base class for two-point functions expressed in
reciprocal space i.e. a matrix A_{G,G&#8217;}(q, omega)</p>
<dl class="method">
<dt id="abipy.electrons.scr.WGGFunction.gindex">
<code class="descname">gindex</code><span class="sig-paren">(</span><em>gvec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#WGGFunction.gindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.gindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the index of gvec. If gvec is an int, gvec is returned.
Raises <cite>ValueError</cite> if gvec is not found.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.WGGFunction.imag_wpts">
<code class="descname">imag_wpts</code><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.imag_wpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Imaginary frequencies in Hartree</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.WGGFunction.latex_label">
<code class="descname">latex_label</code><span class="sig-paren">(</span><em>cplx_mode</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#WGGFunction.latex_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.latex_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a latex string to be passed to matplotlib.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.WGGFunction.ng">
<code class="descname">ng</code><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.ng" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of G-vectors</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.WGGFunction.nw">
<code class="descname">nw</code><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.nw" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of frequencies.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.WGGFunction.plot_ggmat">
<code class="descname">plot_ggmat</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#WGGFunction.plot_ggmat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.plot_ggmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Use imshow for plotting W_GG&#8217;.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">cplx_mode:
wpos: List of frequency indices to plot. If None, the first</p>
<blockquote class="last">
<div>frequency is used (usually w=0). if wpos == &#8220;all&#8221;
all frequencies are shown (use it carefully)
Other possible values: &#8220;real&#8221; if only real frequencies are wanted.
&#8220;imag&#8221; for imaginary frequencies only.</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.WGGFunction.plot_w">
<code class="descname">plot_w</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#WGGFunction.plot_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.plot_w" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the frequency dependence of W_{g1, g2}</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">gvec1, gvec2:
waxis: &#8220;real&#8221; to plot along the real axis, &#8220;imag&#8221; for the imaginary axis.
cplx_mode: string defining the data to print.</p>
<blockquote>
<div>Possible choices are (case-insensitive): <cite>re</cite> for the real part
&#8220;im&#8221; for the imaginary part, &#8220;abs&#8221; for the absolute value.
&#8220;angle&#8221; will display the phase of the complex number in radians.
Options can be concatenated with &#8220;-&#8221; e.g. &#8220;re-im&#8221;</div></blockquote>
<p class="last">ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</p>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>&#8216;abc.png&#8217; or &#8216;abc.eps&#8217; to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True if to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.WGGFunction.real_wpts">
<code class="descname">real_wpts</code><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.real_wpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Real frequencies in Hartree</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.WGGFunction.wggmat_imagw">
<code class="descname">wggmat_imagw</code><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.wggmat_imagw" title="Permalink to this definition">¶</a></dt>
<dd><p>The slice of ggmat along the imaginary axis.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.WGGFunction.wggmat_realw">
<code class="descname">wggmat_realw</code><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.wggmat_realw" title="Permalink to this definition">¶</a></dt>
<dd><p>The slice of ggmat along the real axis.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.WGGFunction.windex">
<code class="descname">windex</code><span class="sig-paren">(</span><em>w</em>, <em>atol=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#WGGFunction.windex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.WGGFunction.windex" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the index of the <strong>closest</strong> frequency in <cite>wpts</cite>.</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gw_api.html" class="btn btn-neutral float-right" title="gw package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="abio_api.html" class="btn btn-neutral" title="abio Package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, The ABINIT group.
      Last updated on Mar 07, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>